(function(O,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],a):(O=typeof globalThis<"u"?globalThis:O||self,a(O.VGoogleMaps={},O.Vue))})(this,function(O,a){"use strict";function ue(s,e,t,n){function o(i){return i instanceof t?i:new t(function(r){r(i)})}return new(t||(t=Promise))(function(i,r){function h(c){try{d(n.next(c))}catch(m){r(m)}}function l(c){try{d(n.throw(c))}catch(m){r(m)}}function d(c){c.done?i(c.value):o(c.value).then(h,l)}d((n=n.apply(s,[])).next())})}typeof SuppressedError=="function"&&SuppressedError;function he(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var de=function s(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,o,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(o=n;o--!==0;)if(!s(e[o],t[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[o]))return!1;for(o=n;o--!==0;){var r=i[o];if(!s(e[r],t[r]))return!1}return!0}return e!==e&&t!==t},pe=he(de);const H="__googleMapsScriptId";var j;(function(s){s[s.INITIALIZED=0]="INITIALIZED",s[s.LOADING=1]="LOADING",s[s.SUCCESS=2]="SUCCESS",s[s.FAILURE=3]="FAILURE"})(j||(j={}));class S{constructor({apiKey:e,authReferrerPolicy:t,channel:n,client:o,id:i=H,language:r,libraries:h=[],mapIds:l,nonce:d,region:c,retries:m=3,url:p="https://maps.googleapis.com/maps/api/js",version:g}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=e,this.authReferrerPolicy=t,this.channel=n,this.client=o,this.id=i||H,this.language=r,this.libraries=h,this.mapIds=l,this.nonce=d,this.region=c,this.retries=m,this.url=p,this.version=g,S.instance){if(!pe(this.options,S.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(S.instance.options)}`);return S.instance}S.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?j.FAILURE:this.done?j.SUCCESS:this.loading?j.LOADING:j.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+=`&key=${this.apiKey}`),this.channel&&(e+=`&channel=${this.channel}`),this.client&&(e+=`&client=${this.client}`),this.libraries.length>0&&(e+=`&libraries=${this.libraries.join(",")}`),this.language&&(e+=`&language=${this.language}`),this.region&&(e+=`&region=${this.region}`),this.version&&(e+=`&v=${this.version}`),this.mapIds&&(e+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(e+=`&auth_referrer_policy=${this.authReferrerPolicy}`),e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,t)=>{this.loadCallback(n=>{n?t(n.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,t;if(document.getElementById(this.id)){this.callback();return}const n={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(n).forEach(i=>!n[i]&&delete n[i]),!((t=(e=window==null?void 0:window.google)===null||e===void 0?void 0:e.maps)===null||t===void 0)&&t.importLibrary||(i=>{let r,h,l,d="The Google Maps JavaScript API",c="google",m="importLibrary",p="__ib__",g=document,f=window;f=f[c]||(f[c]={});const v=f.maps||(f.maps={}),u=new Set,y=new URLSearchParams,k=()=>r||(r=new Promise((M,R)=>ue(this,void 0,void 0,function*(){var x;yield h=g.createElement("script"),h.id=this.id,y.set("libraries",[...u]+"");for(l in i)y.set(l.replace(/[A-Z]/g,K=>"_"+K[0].toLowerCase()),i[l]);y.set("callback",c+".maps."+p),h.src=this.url+"?"+y,v[p]=M,h.onerror=()=>r=R(Error(d+" could not load.")),h.nonce=this.nonce||((x=g.querySelector("script[nonce]"))===null||x===void 0?void 0:x.nonce)||"",g.head.append(h)})));v[m]?console.warn(d+" only loads once. Ignoring:",i):v[m]=(M,...R)=>u.add(M)&&k().then(()=>v[m](M,...R))})(n);const o=this.libraries.map(i=>this.importLibrary(i));o.length||o.push(this.importLibrary("core")),Promise.all(o).then(()=>this.callback(),i=>{const r=new ErrorEvent("error",{error:i});this.loadErrorCallback(r)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){const t=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${t} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},t)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading=!0,this.setScript()}}}const I=a.ref(null),V=a.ref(null),W=a.ref(null),Y=a.ref(null),Q=a.ref(null);async function fe(s,e=[]){I.value||(I.value=new S({apiKey:s,libraries:e}),V.value=await I.value.importLibrary("core"),W.value=await I.value.importLibrary("maps"),Y.value=await I.value.importLibrary("marker"),Q.value=await I.value.importLibrary("visualization"))}function E(){return{maps:W,init:fe,core:V,loader:I,markers:Y,visualization:Q}}function me(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var ge=function s(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,o,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(o=n;o--!==0;)if(!s(e[o],t[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[o]))return!1;for(o=n;o--!==0;){var r=i[o];if(!s(e[r],t[r]))return!1}return!0}return e!==e&&t!==t};const w=me(ge),b=Symbol("map"),X=Symbol("marker"),ee=Symbol("marker-clusterer"),ye=a.defineComponent({__name:"VGoogleMap",props:a.mergeModels({class:{},options:{}},{zoom:{default:null},zoomModifiers:{},center:{default:null},centerModifiers:{}}),emits:a.mergeModels(["ready","click"],["update:zoom","update:center"]),setup(s,{expose:e,emit:t}){const n=s,o=t,i=a.useModel(s,"zoom"),r=a.useModel(s,"center"),{maps:h}=E(),l=a.ref(!1),d=a.ref(null);let c=null,m=null,p=null;const g=a.ref(null);a.onMounted(async()=>{var u,y;!h.value||!g.value||(d.value=a.markRaw(new h.value.Map(g.value,{...n.options,zoom:i.value??((u=n.options)==null?void 0:u.zoom),center:r.value??((y=n.options)==null?void 0:y.center)})),l.value=!0,await a.nextTick(),f(),o("ready"))});function f(){d.value&&(c=d.value.addListener("click",u=>{o("click",u)}),m=d.value.addListener("dragend",()=>{var u,y;r.value=((y=(u=d.value)==null?void 0:u.getCenter())==null?void 0:y.toJSON())??null}),p=d.value.addListener("zoom_changed",()=>{var u;i.value=((u=d.value)==null?void 0:u.getZoom())??0}))}function v(){c==null||c.remove(),m==null||m.remove(),p==null||p.remove()}return a.watch(()=>n.options,(u,y)=>{!d.value||w(u,y)||d.value.setOptions(n.options)},{deep:!0}),a.watch(r,(u,y)=>{w(u,y)||!d.value||!u||d.value.setCenter({...u})}),a.watch(i,(u,y)=>{w(u,y)||!d.value||!u||d.value.setZoom(u)}),e({map:d}),a.provide(b,d),a.onBeforeUnmount(()=>{v(),d.value=null}),(u,y)=>(a.openBlock(),a.createElementBlock(a.Fragment,null,[a.createElementVNode("div",{ref_key:"mapRef",ref:g,class:a.normalizeClass(n.class)},null,2),l.value?a.renderSlot(u.$slots,"default",{key:0}):a.createCommentVNode("",!0)],64))}}),ve=a.defineComponent({name:"VGoogleCircle",props:{options:{required:!0,type:Object},center:{default:null,type:Object},radius:{default:null,type:Number}},emits:["click","update:center","update:radius"],setup(s,{emit:e,expose:t,slots:n}){const{maps:o}=E(),i=a.inject(b,a.ref(null)),r=a.ref(null);let h=null,l=null,d=null;a.onMounted(()=>{var f,v;i.value&&o.value&&(r.value=a.markRaw(new o.value.Circle({...s.options,map:i.value,center:c.value??((f=s.options)==null?void 0:f.center),radius:m.value??((v=s.options)==null?void 0:v.radius)})),p())});const c=a.computed({get(){return s.center},set(f){e("update:center",f)}}),m=a.computed({get(){return s.radius},set(f){e("update:radius",f)}});function p(){r.value&&(h=r.value.addListener("click",f=>{e("click",f)}),l=r.value.addListener("radius_changed",()=>{var f;m.value=((f=r.value)==null?void 0:f.getRadius())??null}),d=r.value.addListener("center_changed",()=>{var v,u;const f=(u=(v=r.value)==null?void 0:v.getCenter())==null?void 0:u.toJSON();f&&(c.value={...f})}))}function g(){h==null||h.remove(),l==null||l.remove(),d==null||d.remove()}return a.watch(()=>s.options,(f,v)=>{!r.value||w(f,v)||r.value.setOptions(s.options)},{deep:!0}),a.watch(c,(f,v)=>{!r.value||!f||w(f,v)||r.value.setCenter({...f})}),a.watch(m,(f,v)=>{!r.value||!f||w(f,v)||r.value.setRadius(f)}),t({circle:r}),a.onBeforeUnmount(()=>{g(),r.value&&(r.value.setMap(null),r.value=null)}),()=>{var f;return(f=n.default)==null?void 0:f.call(n)}}}),ke=a.defineComponent({name:"VGoogleHeatmap",props:{options:{required:!0,type:Object}},setup(s,{expose:e,slots:t}){const{visualization:n}=E(),o=a.inject(b,a.ref(null)),i=a.ref(null);return a.onMounted(()=>{o.value&&n.value&&(i.value=a.markRaw(new n.value.HeatmapLayer({map:o.value,...s.options})))}),a.watch(()=>s.options,(r,h)=>{!i.value||w(r,h)||i.value.setOptions(s.options)},{deep:!0}),e({heatmap:i}),a.onBeforeUnmount(()=>{i.value&&(i.value.setMap(null),i.value=null)}),()=>{var r;return(r=t.default)==null?void 0:r.call(t)}}}),Me=a.defineComponent({name:"VGooglePolygon",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","mouseover","mouseout","update:model-value"],setup(s,{emit:e,expose:t,slots:n}){const{maps:o}=E(),i=a.inject(b,a.ref(null)),r=a.ref(null);let h=null,l=null,d=null,c=null;a.onMounted(()=>{var f;i.value&&o.value&&(r.value=a.markRaw(new o.value.Polygon({...s.options,map:i.value,paths:m.value?[...m.value]:(f=s.options)==null?void 0:f.paths})),p())});const m=a.computed({get(){return s.modelValue},set(f){e("update:model-value",f)}});function p(){r.value&&(h=r.value.addListener("click",f=>{e("click",f)}),d=r.value.addListener("mouseout",f=>{e("mouseout",f)}),c=r.value.addListener("mouseover",f=>{e("mouseover",f)}),l=r.value.addListener("mouseup",()=>{var v,u,y;const f=(y=(u=(v=r.value)==null?void 0:v.getPath())==null?void 0:u.getArray())==null?void 0:y.map(k=>k.toJSON());f&&(m.value=[...f])}))}function g(){h==null||h.remove(),l==null||l.remove(),d==null||d.remove(),c==null||c.remove()}return a.watch(()=>s.options,(f,v)=>{!r.value||w(f,v)||r.value.setOptions(s.options)},{deep:!0}),a.watch(m,(f,v)=>{!r.value||!f||w(f,v)||r.value.setPath(f)}),t({polygon:r}),a.onBeforeUnmount(()=>{g(),r.value&&(r.value.setMap(null),r.value=null)}),()=>{var f;return(f=n.default)==null?void 0:f.call(n)}}}),we={key:0,style:{display:"none"}},te=a.defineComponent({__name:"VGoogleInfoWindow",props:a.mergeModels({options:{default:null}},{modelValue:{type:Boolean,default:!1,required:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(s,{expose:e}){const t=s,n=a.useModel(s,"modelValue"),o=a.useSlots(),{maps:i}=E(),r=a.inject(b,a.ref(null)),h=a.inject(X,a.ref(null)),l=a.ref(!1),d=a.ref(),c=a.ref(null);let m=null,p=null;a.onMounted(async()=>{var k;i.value&&(c.value=a.markRaw(new i.value.InfoWindow({...t.options,content:g.value&&!f.value?d.value:(k=t.options)==null?void 0:k.content})),await a.nextTick(),v(),n.value&&y())});const g=a.computed(()=>{var k,M;return((M=(k=o.default)==null?void 0:k.call(o))==null?void 0:M[0])??null}),f=a.computed(()=>{var k;return((k=g.value)==null?void 0:k.type)===Comment});function v(){!h.value||!c.value||(p=h.value.addListener("click",y),m=c.value.addListener("closeclick",y))}function u(){p&&p.remove(),m&&m.remove()}function y(){!c.value||!r.value||(l.value=!l.value,l.value?c.value.open({map:r.value,anchor:h.value}):c.value.close(),n.value=l.value)}return a.watch(()=>t.options,(k,M)=>{!c.value||w(k,M)||c.value.setOptions(t.options)},{deep:!0}),a.watch(n,k=>{k===null||k===l.value||y()}),e({infoWindow:c}),a.onBeforeUnmount(()=>{u(),c.value&&(c.value.close(),c.value=null)}),(k,M)=>g.value&&!f.value?(a.openBlock(),a.createElementBlock("div",we,[a.createElementVNode("div",{ref_key:"contentRef",ref:d},[a.renderSlot(k.$slots,"default")],512)])):a.createCommentVNode("",!0)}}),_e={key:0,style:{display:"none"}},Ee=a.defineComponent({__name:"VGoogleMarker",props:a.mergeModels({options:{}},{modelValue:{default:null,required:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(s,{expose:e}){const t=s,n=a.useModel(s,"modelValue"),o=a.useSlots(),{markers:i}=E(),r=a.inject(b,a.ref(null)),h=a.inject(ee,a.ref(null)),l=a.ref();let d=null;const c=a.ref(null);a.onMounted(async()=>{var u,y;i.value&&(c.value=a.markRaw(new i.value.AdvancedMarkerElement({...t.options,position:n.value??((u=t.options)==null?void 0:u.position),map:h.value===null?r.value:null,content:m.value&&!p.value&&!g.value?l.value:(y=t.options)==null?void 0:y.content})),await a.nextTick(),h.value&&h.value.addMarker(c.value),f())});const m=a.computed(()=>{var u,y;return((y=(u=o.default)==null?void 0:u.call(o))==null?void 0:y[0])??null}),p=a.computed(()=>{var u;return((u=m.value)==null?void 0:u.type)===Comment}),g=a.computed(()=>{var u;return((u=m.value)==null?void 0:u.type)===te});function f(){c.value&&(d=c.value.addListener("dragend",u=>{var y;n.value=((y=u.latLng)==null?void 0:y.toJSON())??null}))}function v(){d==null||d.remove()}return a.watch(()=>t.options,(u,y)=>{!c.value||w(u,y)||(u!=null&&u.title&&(c.value.title=u.title),u!=null&&u.zIndex&&(c.value.zIndex=u.zIndex),u!=null&&u.content&&(c.value.content=u.content),u!=null&&u.position&&(c.value.position=u.position),u!=null&&u.gmpDraggable&&(c.value.gmpDraggable=u.gmpDraggable))},{deep:!0}),a.watch(n,(u,y)=>{!c.value||w(u,y)||(c.value.position=u)}),e({marker:c}),a.provide(X,c),a.onBeforeUnmount(()=>{v(),c.value&&(h.value&&h.value.removeMarker(c.value),c.value.map=null,c.value=null)}),(u,y)=>m.value&&!p.value?(a.openBlock(),a.createElementBlock("div",_e,[a.createElementVNode("div",{ref_key:"contentRef",ref:l},[a.renderSlot(u.$slots,"default")],512)])):a.createCommentVNode("",!0)}}),be=a.defineComponent({name:"VGooglePolyline",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","update:model-value"],setup(s,{emit:e,expose:t,slots:n}){const{maps:o}=E(),i=a.inject(b,a.ref(null)),r=a.ref(null);let h=null,l=null;a.onMounted(()=>{var p;i.value&&o.value&&(r.value=a.markRaw(new o.value.Polyline({...s.options,map:i.value,path:d.value?[...d.value]:(p=s.options)==null?void 0:p.path})),c())});const d=a.computed({get(){return s.modelValue},set(p){e("update:model-value",p)}});function c(){r.value&&(h=r.value.addListener("click",p=>{e("click",p)}),l=r.value.addListener("mouseup",()=>{var g,f,v;const p=(v=(f=(g=r.value)==null?void 0:g.getPath())==null?void 0:f.getArray())==null?void 0:v.map(u=>u.toJSON());p&&(d.value=[...p])}))}function m(){h==null||h.remove(),l==null||l.remove()}return a.watch(()=>s.options,(p,g)=>{!r.value||w(p,g)||r.value.setOptions(s.options)},{deep:!0}),a.watch(d,(p,g)=>{!r.value||!p||w(p,g)||r.value.setPath(p)}),t({polyline:r}),a.onBeforeUnmount(()=>{m(),r.value&&(r.value.setMap(null),r.value=null)}),()=>{var p;return(p=n.default)==null?void 0:p.call(n)}}}),Oe=a.defineComponent({name:"VGoogleRectangle",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","update:model-value"],setup(s,{emit:e,expose:t,slots:n}){const{maps:o}=E(),i=a.inject(b,a.ref(null)),r=a.ref(null);let h=null,l=null;a.onMounted(()=>{var p;i.value&&o.value&&(r.value=a.markRaw(new o.value.Rectangle({...s.options,map:i.value,bounds:d.value??((p=s.options)==null?void 0:p.bounds)})),c())});const d=a.computed({get(){return s.modelValue},set(p){e("update:model-value",p)}});function c(){r.value&&(h=r.value.addListener("click",p=>{e("click",p)}),l=r.value.addListener("bounds_changed",()=>{var g,f;const p=(f=(g=r.value)==null?void 0:g.getBounds())==null?void 0:f.toJSON();p&&(d.value={...p})}))}function m(){h==null||h.remove(),l==null||l.remove()}return a.watch(()=>s.options,(p,g)=>{!r.value||w(p,g)||r.value.setOptions(s.options)},{deep:!0}),a.watch(d,(p,g)=>{!r.value||!p||w(p,g)||r.value.setBounds(p)}),t({rectangle:r}),a.onBeforeUnmount(()=>{m(),r.value&&(r.value.setMap(null),r.value=null)}),()=>{var p;return(p=n.default)==null?void 0:p.call(n)}}}),ne=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],B=1,T=8;class F{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,n]=new Uint8Array(e,0,2);if(t!==219)throw new Error("Data does not appear to be in a KDBush format.");const o=n>>4;if(o!==B)throw new Error(`Got v${o} data when expected v${B}.`);const i=ne[n&15];if(!i)throw new Error("Unrecognized array type.");const[r]=new Uint16Array(e,2,1),[h]=new Uint32Array(e,4,1);return new F(h,r,i,e)}constructor(e,t=64,n=Float64Array,o){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const i=ne.indexOf(this.ArrayType),r=e*2*this.ArrayType.BYTES_PER_ELEMENT,h=e*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-h%8)%8;if(i<0)throw new Error(`Unexpected typed array class: ${n}.`);o&&o instanceof ArrayBuffer?(this.data=o,this.ids=new this.IndexArrayType(this.data,T,e),this.coords=new this.ArrayType(this.data,T+h+l,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(T+r+h+l),this.ids=new this.IndexArrayType(this.data,T,e),this.coords=new this.ArrayType(this.data,T+h+l,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(B<<4)+i]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=t,n}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return $(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,n,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:r,nodeSize:h}=this,l=[0,i.length-1,0],d=[];for(;l.length;){const c=l.pop()||0,m=l.pop()||0,p=l.pop()||0;if(m-p<=h){for(let u=p;u<=m;u++){const y=r[2*u],k=r[2*u+1];y>=e&&y<=n&&k>=t&&k<=o&&d.push(i[u])}continue}const g=p+m>>1,f=r[2*g],v=r[2*g+1];f>=e&&f<=n&&v>=t&&v<=o&&d.push(i[g]),(c===0?e<=f:t<=v)&&(l.push(p),l.push(g-1),l.push(1-c)),(c===0?n>=f:o>=v)&&(l.push(g+1),l.push(m),l.push(1-c))}return d}within(e,t,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:o,coords:i,nodeSize:r}=this,h=[0,o.length-1,0],l=[],d=n*n;for(;h.length;){const c=h.pop()||0,m=h.pop()||0,p=h.pop()||0;if(m-p<=r){for(let u=p;u<=m;u++)oe(i[2*u],i[2*u+1],e,t)<=d&&l.push(o[u]);continue}const g=p+m>>1,f=i[2*g],v=i[2*g+1];oe(f,v,e,t)<=d&&l.push(o[g]),(c===0?e-n<=f:t-n<=v)&&(h.push(p),h.push(g-1),h.push(1-c)),(c===0?e+n>=f:t+n>=v)&&(h.push(g+1),h.push(m),h.push(1-c))}return l}}function $(s,e,t,n,o,i){if(o-n<=t)return;const r=n+o>>1;re(s,e,r,n,o,i),$(s,e,t,n,r-1,1-i),$(s,e,t,r+1,o,1-i)}function re(s,e,t,n,o,i){for(;o>n;){if(o-n>600){const d=o-n+1,c=t-n+1,m=Math.log(d),p=.5*Math.exp(2*m/3),g=.5*Math.sqrt(m*p*(d-p)/d)*(c-d/2<0?-1:1),f=Math.max(n,Math.floor(t-c*p/d+g)),v=Math.min(o,Math.floor(t+(d-c)*p/d+g));re(s,e,t,f,v,i)}const r=e[2*t+i];let h=n,l=o;for(G(s,e,n,t),e[2*o+i]>r&&G(s,e,n,o);h<l;){for(G(s,e,h,l),h++,l--;e[2*h+i]<r;)h++;for(;e[2*l+i]>r;)l--}e[2*n+i]===r?G(s,e,n,l):(l++,G(s,e,l,o)),l<=t&&(n=l+1),t<=l&&(o=l-1)}}function G(s,e,t,n){D(s,t,n),D(e,2*t,2*n),D(e,2*t+1,2*n+1)}function D(s,e,t){const n=s[e];s[e]=s[t],s[t]=n}function oe(s,e,t,n){const o=s-t,i=e-n;return o*o+i*i}const Ce={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:s=>s},se=Math.fround||(s=>e=>(s[0]=+e,s[0]))(new Float32Array(1)),L=2,C=3,z=4,A=5,ie=6;class Ae{constructor(e){this.options=Object.assign(Object.create(Ce),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:n,maxZoom:o}=this.options;t&&console.time("total time");const i=`prepare ${e.length} points`;t&&console.time(i),this.points=e;const r=[];for(let l=0;l<e.length;l++){const d=e[l];if(!d.geometry)continue;const[c,m]=d.geometry.coordinates,p=se(U(c)),g=se(Z(m));r.push(p,g,1/0,l,-1,1),this.options.reduce&&r.push(0)}let h=this.trees[o+1]=this._createTree(r);t&&console.timeEnd(i);for(let l=o;l>=n;l--){const d=+Date.now();h=this.trees[l]=this._createTree(this._cluster(h,l)),t&&console.log("z%d: %d clusters in %dms",l,h.numItems,+Date.now()-d)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let n=((e[0]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,e[1]));let i=e[2]===180?180:((e[2]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,i=180;else if(n>i){const m=this.getClusters([n,o,180,r],t),p=this.getClusters([-180,o,i,r],t);return m.concat(p)}const h=this.trees[this._limitZoom(t)],l=h.range(U(n),Z(r),U(i),Z(o)),d=h.data,c=[];for(const m of l){const p=this.stride*m;c.push(d[p+A]>1?ae(d,p,this.clusterProps):this.points[d[p+C]])}return c}getChildren(e){const t=this._getOriginId(e),n=this._getOriginZoom(e),o="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(o);const r=i.data;if(t*this.stride>=r.length)throw new Error(o);const h=this.options.radius/(this.options.extent*Math.pow(2,n-1)),l=r[t*this.stride],d=r[t*this.stride+1],c=i.within(l,d,h),m=[];for(const p of c){const g=p*this.stride;r[g+z]===e&&m.push(r[g+A]>1?ae(r,g,this.clusterProps):this.points[r[g+C]])}if(m.length===0)throw new Error(o);return m}getLeaves(e,t,n){t=t||10,n=n||0;const o=[];return this._appendLeaves(o,e,t,n,0),o}getTile(e,t,n){const o=this.trees[this._limitZoom(e)],i=Math.pow(2,e),{extent:r,radius:h}=this.options,l=h/r,d=(n-l)/i,c=(n+1+l)/i,m={features:[]};return this._addTileFeatures(o.range((t-l)/i,d,(t+1+l)/i,c),o.data,t,n,i,m),t===0&&this._addTileFeatures(o.range(1-l/i,d,1,c),o.data,i,n,i,m),t===i-1&&this._addTileFeatures(o.range(0,d,l/i,c),o.data,-1,n,i,m),m.features.length?m:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const n=this.getChildren(e);if(t++,n.length!==1)break;e=n[0].properties.cluster_id}return t}_appendLeaves(e,t,n,o,i){const r=this.getChildren(t);for(const h of r){const l=h.properties;if(l&&l.cluster?i+l.point_count<=o?i+=l.point_count:i=this._appendLeaves(e,l.cluster_id,n,o,i):i<o?i++:e.push(h),e.length===n)break}return i}_createTree(e){const t=new F(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let n=0;n<e.length;n+=this.stride)t.add(e[n],e[n+1]);return t.finish(),t.data=e,t}_addTileFeatures(e,t,n,o,i,r){for(const h of e){const l=h*this.stride,d=t[l+A]>1;let c,m,p;if(d)c=le(t,l,this.clusterProps),m=t[l],p=t[l+1];else{const v=this.points[t[l+C]];c=v.properties;const[u,y]=v.geometry.coordinates;m=U(u),p=Z(y)}const g={type:1,geometry:[[Math.round(this.options.extent*(m*i-n)),Math.round(this.options.extent*(p*i-o))]],tags:c};let f;d||this.options.generateId?f=t[l+C]:f=this.points[t[l+C]].id,f!==void 0&&(g.id=f),r.features.push(g)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:n,extent:o,reduce:i,minPoints:r}=this.options,h=n/(o*Math.pow(2,t)),l=e.data,d=[],c=this.stride;for(let m=0;m<l.length;m+=c){if(l[m+L]<=t)continue;l[m+L]=t;const p=l[m],g=l[m+1],f=e.within(l[m],l[m+1],h),v=l[m+A];let u=v;for(const y of f){const k=y*c;l[k+L]>t&&(u+=l[k+A])}if(u>v&&u>=r){let y=p*v,k=g*v,M,R=-1;const x=((m/c|0)<<5)+(t+1)+this.points.length;for(const K of f){const P=K*c;if(l[P+L]<=t)continue;l[P+L]=t;const ce=l[P+A];y+=l[P]*ce,k+=l[P+1]*ce,l[P+z]=x,i&&(M||(M=this._map(l,m,!0),R=this.clusterProps.length,this.clusterProps.push(M)),i(M,this._map(l,P)))}l[m+z]=x,d.push(y/u,k/u,1/0,x,-1,u),i&&d.push(R)}else{for(let y=0;y<c;y++)d.push(l[m+y]);if(u>1)for(const y of f){const k=y*c;if(!(l[k+L]<=t)){l[k+L]=t;for(let M=0;M<c;M++)d.push(l[k+M])}}}}return d}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,n){if(e[t+A]>1){const r=this.clusterProps[e[t+ie]];return n?Object.assign({},r):r}const o=this.points[e[t+C]].properties,i=this.options.map(o);return n&&i===o?Object.assign({},i):i}}function ae(s,e,t){return{type:"Feature",id:s[e+C],properties:le(s,e,t),geometry:{type:"Point",coordinates:[Se(s[e]),Ie(s[e+1])]}}}function le(s,e,t){const n=s[e+A],o=n>=1e4?`${Math.round(n/1e3)}k`:n>=1e3?`${Math.round(n/100)/10}k`:n,i=s[e+ie],r=i===-1?{}:Object.assign({},t[i]);return Object.assign(r,{cluster:!0,cluster_id:s[e+C],point_count:n,point_count_abbreviated:o})}function U(s){return s/360+.5}function Z(s){const e=Math.sin(s*Math.PI/180),t=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return t<0?0:t>1?1:t}function Se(s){return(s-.5)*360}function Ie(s){const e=(180-s*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */function Le(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(s);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(s,n[o])&&(t[n[o]]=s[n[o]]);return t}class _{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,t){this.isAdvancedMarker(e)?e.map=t:e.setMap(t)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class q{constructor({markers:e,position:t}){this.markers=e,t&&(t instanceof google.maps.LatLng?this._position=t:this._position=new google.maps.LatLng(t))}get bounds(){if(this.markers.length===0&&!this._position)return;const e=new google.maps.LatLngBounds(this._position,this._position);for(const t of this.markers)e.extend(_.getPosition(t));return e}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>_.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(_.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class xe{constructor({maxZoom:e=16}){this.maxZoom=e}noop({markers:e}){return Pe(e)}}const Pe=s=>s.map(t=>new q({position:_.getPosition(t),markers:[t]}));class je extends xe{constructor(e){var{maxZoom:t,radius:n=60}=e,o=Le(e,["maxZoom","radius"]);super({maxZoom:t}),this.state={zoom:-1},this.superCluster=new Ae(Object.assign({maxZoom:this.maxZoom,radius:n},o))}calculate(e){let t=!1;const n={zoom:e.map.getZoom()};if(!w(e.markers,this.markers)){t=!0,this.markers=[...e.markers];const o=this.markers.map(i=>{const r=_.getPosition(i);return{type:"Feature",geometry:{type:"Point",coordinates:[r.lng(),r.lat()]},properties:{marker:i}}});this.superCluster.load(o)}return t||(this.state.zoom<=this.maxZoom||n.zoom<=this.maxZoom)&&(t=!w(this.state,n)),this.state=n,t&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:t}}cluster({map:e}){return this.superCluster.getClusters([-180,-90,180,90],Math.round(e.getZoom())).map(t=>this.transformCluster(t))}transformCluster({geometry:{coordinates:[e,t]},properties:n}){if(n.cluster)return new q({markers:this.superCluster.getLeaves(n.cluster_id,1/0).map(i=>i.properties.marker),position:{lat:t,lng:e}});const o=n.marker;return new q({markers:[o],position:_.getPosition(o)})}}class Re{constructor(e,t){this.markers={sum:e.length};const n=t.map(i=>i.count),o=n.reduce((i,r)=>i+r,0);this.clusters={count:t.length,markers:{mean:o/t.length,sum:o,min:Math.min(...n),max:Math.max(...n)}}}}class Te{render({count:e,position:t},n,o){const r=`<svg fill="${e>Math.max(10,n.clusters.markers.mean)?"#ff0000":"#0000ff"}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">${e}</text>
</svg>`,h=`Cluster of ${e} markers`,l=Number(google.maps.Marker.MAX_ZINDEX)+e;if(_.isAdvancedMarkerAvailable(o)){const m=new DOMParser().parseFromString(r,"image/svg+xml").documentElement;m.setAttribute("transform","translate(0 25)");const p={map:o,position:t,zIndex:l,title:h,content:m};return new google.maps.marker.AdvancedMarkerElement(p)}const d={position:t,zIndex:l,title:h,icon:{url:`data:image/svg+xml;base64,${btoa(r)}`,anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(d)}}function Ge(s,e){for(let t in e.prototype)s.prototype[t]=e.prototype[t]}class J{constructor(){Ge(J,google.maps.OverlayView)}}var N;(function(s){s.CLUSTERING_BEGIN="clusteringbegin",s.CLUSTERING_END="clusteringend",s.CLUSTER_CLICK="click"})(N||(N={}));const Ne=(s,e,t)=>{t.fitBounds(e.bounds)};class Ue extends J{constructor({map:e,markers:t=[],algorithmOptions:n={},algorithm:o=new je(n),renderer:i=new Te,onClusterClick:r=Ne}){super(),this.markers=[...t],this.clusters=[],this.algorithm=o,this.renderer=i,this.onClusterClick=r,e&&this.setMap(e)}addMarker(e,t){this.markers.includes(e)||(this.markers.push(e),t||this.render())}addMarkers(e,t){e.forEach(n=>{this.addMarker(n,!0)}),t||this.render()}removeMarker(e,t){const n=this.markers.indexOf(e);return n===-1?!1:(_.setMap(e,null),this.markers.splice(n,1),t||this.render(),!0)}removeMarkers(e,t){let n=!1;return e.forEach(o=>{n=this.removeMarker(o,!0)||n}),n&&!t&&this.render(),n}clearMarkers(e){this.markers.length=0,e||this.render()}render(){const e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,N.CLUSTERING_BEGIN,this);const{clusters:t,changed:n}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(n||n==null){const o=new Set;for(const r of t)r.markers.length==1&&o.add(r.markers[0]);const i=[];for(const r of this.clusters)r.marker!=null&&(r.markers.length==1?o.has(r.marker)||_.setMap(r.marker,null):i.push(r.marker));this.clusters=t,this.renderClusters(),requestAnimationFrame(()=>i.forEach(r=>_.setMap(r,null)))}google.maps.event.trigger(this,N.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>_.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){const e=new Re(this.markers,this.clusters),t=this.getMap();this.clusters.forEach(n=>{n.markers.length===1?n.marker=n.markers[0]:(n.marker=this.renderer.render(n,e,t),n.markers.forEach(o=>_.setMap(o,null)),this.onClusterClick&&n.marker.addListener("click",o=>{google.maps.event.trigger(this,N.CLUSTER_CLICK,n),this.onClusterClick(o,n,t)})),_.setMap(n.marker,t)})}}const Ze=a.defineComponent({name:"VGoogleMarkerClusterer",props:{options:{default:null,type:Object}},setup(s,{slots:e}){const t=a.inject(b,a.ref(null)),n=a.ref(null);return t.value&&(n.value=a.markRaw(new Ue({...s.options,map:t.value}))),a.provide(ee,n),a.onBeforeUnmount(()=>{n.value&&(n.value.setMap(null),n.value.clearMarkers(),n.value=null)}),()=>{var o;return(o=e.default)==null?void 0:o.call(e)}}});function Be(s){s.component("VGoogleMap",ye),s.component("VGoogleCircle",ve),s.component("VGoogleMarker",Ee),s.component("VGoogleHeatmap",ke),s.component("VGooglePolygon",Me),s.component("VGooglePolyline",be),s.component("VGoogleRectangle",Oe),s.component("VGoogleInfoWindow",te),s.component("VGoogleMarkerClusterer",Ze)}O.useGoogleMapsLoader=E,O.vGoogleMaps=Be,Object.defineProperty(O,Symbol.toStringTag,{value:"Module"})});
