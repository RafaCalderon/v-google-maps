"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const l=require("vue");var C=function o(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,r,s;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!o(e[r],t[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){var a=s[r];if(!o(e[a],t[a]))return!1}return!0}return e!==e&&t!==t};const k="__googleMapsScriptId";var p;(function(o){o[o.INITIALIZED=0]="INITIALIZED",o[o.LOADING=1]="LOADING",o[o.SUCCESS=2]="SUCCESS",o[o.FAILURE=3]="FAILURE"})(p||(p={}));class u{constructor({apiKey:e,authReferrerPolicy:t,channel:n,client:r,id:s=k,language:a,libraries:d=[],mapIds:g,nonce:v,region:h,retries:f=3,url:m="https://maps.googleapis.com/maps/api/js",version:y}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=e,this.authReferrerPolicy=t,this.channel=n,this.client=r,this.id=s||k,this.language=a,this.libraries=d,this.mapIds=g,this.nonce=v,this.region=h,this.retries=f,this.url=m,this.version=y,u.instance){if(!C(this.options,u.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(u.instance.options)}`);return u.instance}u.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?p.FAILURE:this.done?p.SUCCESS:this.loading?p.LOADING:p.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+=`?callback=${this.CALLBACK}`,this.apiKey&&(e+=`&key=${this.apiKey}`),this.channel&&(e+=`&channel=${this.channel}`),this.client&&(e+=`&client=${this.client}`),this.libraries.length>0&&(e+=`&libraries=${this.libraries.join(",")}`),this.language&&(e+=`&language=${this.language}`),this.region&&(e+=`&region=${this.region}`),this.version&&(e+=`&v=${this.version}`),this.mapIds&&(e+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(e+=`&auth_referrer_policy=${this.authReferrerPolicy}`),e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,t)=>{this.loadCallback(n=>{n?t(n.error):e(window.google)})})}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){if(document.getElementById(this.id)){this.callback();return}const e=this.createUrl(),t=document.createElement("script");t.id=this.id,t.type="text/javascript",t.src=e,t.onerror=this.loadErrorCallback.bind(this),t.defer=!0,t.async=!0,this.nonce&&(t.nonce=this.nonce),document.head.appendChild(t)}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){const t=this.errors.length*Math.pow(2,this.errors.length);console.log(`Failed to load Google Maps script, retrying in ${t} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},t)}else this.onerrorEvent=e,this.callback()}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}}const I=l.ref(null);async function b(o,e=[]){if(I.value)return;const t=new u({apiKey:o,libraries:e});I.value=await t.load()}function E(){return{gmapApi:I,load:b}}var O=function o(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,r,s;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!==0;)if(!o(e[r],t[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){var a=s[r];if(!o(e[a],t[a]))return!1}return!0}return e!==e&&t!==t};const w=l.defineComponent({__name:"VGoogleMap",props:{width:{required:!0,type:String},height:{required:!0,type:String},borderRadius:{default:"unset",type:String},options:{required:!0,type:Object},center:{default:null,type:Object},zoom:{default:null,type:Number}},emits:["ready","click","update:zoom","update:center"],setup(o,{emit:e}){const t=o;l.useCssVars(i=>({"3e550e08":o.width,"200aacb1":o.height,"2018c7e8":o.borderRadius}));const{gmapApi:n}=E(),r=l.ref(!1),s=l.ref(null),a=l.ref(null);let d=null,g=null,v=null;l.provide("google-map",s);const h=l.computed({get(){return t.center},set(i){e("update:center",i)}}),f=l.computed({get(){return t.zoom},set(i){e("update:zoom",i)}});l.onMounted(async()=>{if(!a.value||!n.value)return;const i={...t.options};h.value&&(i.center={...h.value}),f.value&&(i.zoom=f.value),s.value=l.markRaw(new n.value.maps.Map(a.value,{...i})),r.value=!0,await l.nextTick(),m(),e("ready")});function m(){s.value&&(d=s.value.addListener("click",S),g=s.value.addListener("dragend",()=>{var i,c;h.value=((c=(i=s.value)==null?void 0:i.getCenter())==null?void 0:c.toJSON())??null}),v=s.value.addListener("zoom_changed",()=>{var i;f.value=((i=s.value)==null?void 0:i.getZoom())??0}))}function y(){d&&d.remove(),g&&g.remove(),v&&v.remove()}function S(i){e("click",i)}return l.watch(()=>t.options,(i,c)=>{!s.value||O(i,c)||s.value.setOptions(t.options)},{deep:!0}),l.watch(h,(i,c)=>{O(i,c)||!s.value||!i||s.value.setCenter({...i})}),l.watch(f,(i,c)=>{O(i,c)||!s.value||!i||s.value.setZoom(i)}),l.onBeforeUnmount(()=>{y(),s.value=null}),(i,c)=>(l.openBlock(),l.createElementBlock("div",null,[l.createElementVNode("div",{class:"v-google-map__container",ref_key:"mapRef",ref:a},null,512),r.value?l.renderSlot(i.$slots,"default",{key:0},void 0,!0):l.createCommentVNode("",!0)]))}});const _=(o,e)=>{const t=o.__vccOpts||o;for(const[n,r]of e)t[n]=r;return t},j=_(w,[["__scopeId","data-v-028278a8"]]),A=o=>{o.component("VGoogleMaps",j)};exports.useGmapLoader=E;exports.vGoogleMaps=A;
