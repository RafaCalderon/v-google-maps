"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("vue");var G=function r(n,l){if(n===l)return!0;if(n&&l&&typeof n=="object"&&typeof l=="object"){if(n.constructor!==l.constructor)return!1;var i,a,u;if(Array.isArray(n)){if(i=n.length,i!=l.length)return!1;for(a=i;a--!==0;)if(!r(n[a],l[a]))return!1;return!0}if(n.constructor===RegExp)return n.source===l.source&&n.flags===l.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===l.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===l.toString();if(u=Object.keys(n),i=u.length,i!==Object.keys(l).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(l,u[a]))return!1;for(a=i;a--!==0;){var e=u[a];if(!r(n[e],l[e]))return!1}return!0}return n!==n&&l!==l};const j="__googleMapsScriptId";var _;(function(r){r[r.INITIALIZED=0]="INITIALIZED",r[r.LOADING=1]="LOADING",r[r.SUCCESS=2]="SUCCESS",r[r.FAILURE=3]="FAILURE"})(_||(_={}));class C{constructor({apiKey:n,authReferrerPolicy:l,channel:i,client:a,id:u=j,language:e,libraries:d=[],mapIds:p,nonce:m,region:v,retries:g=3,url:y="https://maps.googleapis.com/maps/api/js",version:o}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=n,this.authReferrerPolicy=l,this.channel=i,this.client=a,this.id=u||j,this.language=e,this.libraries=d,this.mapIds=p,this.nonce=m,this.region=v,this.retries=g,this.url=y,this.version=o,C.instance){if(!G(this.options,C.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(C.instance.options)}`);return C.instance}C.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?_.FAILURE:this.done?_.SUCCESS:this.loading?_.LOADING:_.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let n=this.url;return n+=`?callback=${this.CALLBACK}`,this.apiKey&&(n+=`&key=${this.apiKey}`),this.channel&&(n+=`&channel=${this.channel}`),this.client&&(n+=`&client=${this.client}`),this.libraries.length>0&&(n+=`&libraries=${this.libraries.join(",")}`),this.language&&(n+=`&language=${this.language}`),this.region&&(n+=`&region=${this.region}`),this.version&&(n+=`&v=${this.version}`),this.mapIds&&(n+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(n+=`&auth_referrer_policy=${this.authReferrerPolicy}`),n}deleteScript(){const n=document.getElementById(this.id);n&&n.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((n,l)=>{this.loadCallback(i=>{i?l(i.error):n(window.google)})})}loadCallback(n){this.callbacks.push(n),this.execute()}setScript(){if(document.getElementById(this.id)){this.callback();return}const n=this.createUrl(),l=document.createElement("script");l.id=this.id,l.type="text/javascript",l.src=n,l.onerror=this.loadErrorCallback.bind(this),l.defer=!0,l.async=!0,this.nonce&&(l.nonce=this.nonce),document.head.appendChild(l)}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(n){if(this.errors.push(n),this.errors.length<=this.retries){const l=this.errors.length*Math.pow(2,this.errors.length);console.log(`Failed to load Google Maps script, retrying in ${l} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},l)}else this.onerrorEvent=n,this.callback()}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(n=>{n(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}}const b=t.ref(null);async function S(r,n=[]){if(b.value)return;const l=new C({apiKey:r,libraries:n});b.value=await l.load()}function L(){return{gmapApi:b,load:S}}var O=function r(n,l){if(n===l)return!0;if(n&&l&&typeof n=="object"&&typeof l=="object"){if(n.constructor!==l.constructor)return!1;var i,a,u;if(Array.isArray(n)){if(i=n.length,i!=l.length)return!1;for(a=i;a--!==0;)if(!r(n[a],l[a]))return!1;return!0}if(n.constructor===RegExp)return n.source===l.source&&n.flags===l.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===l.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===l.toString();if(u=Object.keys(n),i=u.length,i!==Object.keys(l).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(l,u[a]))return!1;for(a=i;a--!==0;){var e=u[a];if(!r(n[e],l[e]))return!1}return!0}return n!==n&&l!==l};const R={class:"v-google-map__wrapper"},M=t.defineComponent({__name:"VGoogleMap",props:{width:{required:!0,type:String},height:{required:!0,type:String},borderRadius:{default:"unset",type:String},options:{required:!0,type:Object},center:{default:null,type:Object},zoom:{default:null,type:Number}},emits:["ready","click","update:zoom","update:center"],setup(r,{expose:n,emit:l}){const i=r;t.useCssVars(s=>({"77cd9c80":r.width,"6816f9ad":r.height,c9433038:r.borderRadius}));const{gmapApi:a}=L(),u=t.ref(!1),e=t.ref(null),d=t.ref(null);let p=null,m=null,v=null;t.provide("google-map",e);const g=t.computed({get(){return i.center},set(s){l("update:center",s)}}),y=t.computed({get(){return i.zoom},set(s){l("update:zoom",s)}});t.onMounted(async()=>{if(!d.value||!a.value)return;const s={...i.options};g.value&&(s.center={...g.value}),y.value&&(s.zoom=y.value),e.value=t.markRaw(new a.value.maps.Map(d.value,{...s})),u.value=!0,await t.nextTick(),o(),l("ready")});function o(){e.value&&(p=e.value.addListener("click",c),m=e.value.addListener("dragend",()=>{var s,h;g.value=((h=(s=e.value)==null?void 0:s.getCenter())==null?void 0:h.toJSON())??null}),v=e.value.addListener("zoom_changed",()=>{var s;y.value=((s=e.value)==null?void 0:s.getZoom())??0}))}function f(){p&&p.remove(),m&&m.remove(),v&&v.remove()}function c(s){l("click",s)}return t.watch(()=>i.options,(s,h)=>{!e.value||O(s,h)||e.value.setOptions(i.options)},{deep:!0}),t.watch(g,(s,h)=>{O(s,h)||!e.value||!s||e.value.setCenter({...s})}),t.watch(y,(s,h)=>{O(s,h)||!e.value||!s||e.value.setZoom(s)}),n({map:e}),t.onBeforeUnmount(()=>{f(),e.value=null}),(s,h)=>(t.openBlock(),t.createElementBlock("div",R,[t.createElementVNode("div",{class:"v-google-map__container",ref_key:"mapRef",ref:d},null,512),u.value?t.renderSlot(s.$slots,"default",{key:0},void 0,!0):t.createCommentVNode("",!0)]))}});const I=(r,n)=>{const l=r.__vccOpts||r;for(const[i,a]of n)l[i]=a;return l},V=I(M,[["__scopeId","data-v-6a7d8b8f"]]),A=t.defineComponent({name:"VGoogleCircle",props:{options:{required:!0,type:Object},center:{default:null,type:Object},radius:{default:null,type:Number}},emits:["click","update:center","update:radius"],setup(r,{emit:n,expose:l,slots:i}){const{gmapApi:a}=L(),u=t.inject("google-map");t.onMounted(()=>{if(u!=null&&u.value&&a.value){const c={...r.options};v.value&&(c.center={...v.value}),g.value&&(c.radius=g.value),e.value=t.markRaw(new a.value.maps.Circle({map:u.value,...c})),y()}});const e=t.ref(null);let d=null,p=null,m=null;const v=t.computed({get(){return r.center},set(c){n("update:center",c)}}),g=t.computed({get(){return r.radius},set(c){n("update:radius",c)}});function y(){e.value&&(d=e.value.addListener("click",f),p=e.value.addListener("radius_changed",()=>{var c;g.value=((c=e.value)==null?void 0:c.getRadius())??null}),m=e.value.addListener("center_changed",()=>{var s,h;const c=(h=(s=e.value)==null?void 0:s.getCenter())==null?void 0:h.toJSON();c&&(v.value={...c})}))}function o(){d&&d.remove(),p&&p.remove(),m&&m.remove()}function f(c){n("click",c)}return t.watch(()=>r.options,(c,s)=>{!e.value||O(c,s)||e.value.setOptions(r.options)},{deep:!0}),t.watch(v,(c,s)=>{O(c,s)||!e.value||!c||e.value.setCenter({...c})}),t.watch(g,(c,s)=>{O(c,s)||!e.value||!c||e.value.setRadius(c)}),l({circle:e}),t.onBeforeUnmount(()=>{o(),e.value&&(e.value.setMap(null),e.value=null)}),()=>{var c;return(c=i.default)==null?void 0:c.call(i)}}}),E=t.defineComponent({name:"VGoogleMarker",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","update:model-value"],setup(r,{emit:n,expose:l,slots:i}){const{gmapApi:a}=L(),u=t.inject("google-map"),e=t.ref(null);let d=null,p=null;if(u!=null&&u.value&&a.value){const o={...r.options};r.modelValue&&(o.position={...r.modelValue}),e.value=t.markRaw(new a.value.maps.Marker({map:u.value,...o})),v()}const m=t.computed({get(){return r.modelValue},set(o){n("update:model-value",o)}});function v(){e.value&&(d=e.value.addListener("click",y),p=e.value.addListener("mouseup",()=>{var o,f;m.value=((f=(o=e.value)==null?void 0:o.getPosition())==null?void 0:f.toJSON())??null}))}function g(){d&&d.remove(),p&&p.remove()}function y(o){n("click",o)}return t.watch(()=>r.options,(o,f)=>{!e.value||O(o,f)||e.value.setOptions(r.options)},{deep:!0}),t.watch(m,(o,f)=>{O(o,f)||!e.value||e.value.setPosition(o)}),l({marker:e}),t.provide("marker",e),t.onBeforeUnmount(()=>{g(),e.value&&(e.value.setMap(null),e.value=null)}),()=>{var o;return(o=i.default)==null?void 0:o.call(i)}}}),P=t.defineComponent({name:"VGoogleHeatmap",props:{options:{required:!0,type:Object}},setup(r,{expose:n,slots:l}){const{gmapApi:i}=L(),a=t.inject("google-map");t.onMounted(()=>{if(a!=null&&a.value&&i.value){const e={...r.options};u.value=t.markRaw(new i.value.maps.visualization.HeatmapLayer({map:a.value,...e}))}});const u=t.ref(null);return t.watch(()=>r.options,(e,d)=>{!u.value||O(e,d)||u.value.setOptions(r.options)},{deep:!0}),t.onUnmounted(()=>{u.value&&(u.value.setMap(null),u.value=null)}),n({heatmap:u}),()=>{var e;return(e=l.default)==null?void 0:e.call(l)}}}),N=t.defineComponent({name:"VGooglePolygon",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","update:model-value"],setup(r,{emit:n,expose:l,slots:i}){const{gmapApi:a}=L(),u=t.inject("google-map");t.onMounted(()=>{if(u!=null&&u.value&&a.value){const o={...r.options};m.value&&(o.paths=[...m.value]),e.value=t.markRaw(new a.value.maps.Polygon({map:u.value,...o})),v()}});const e=t.ref(null);let d=null,p=null;const m=t.computed({get(){return r.modelValue},set(o){n("update:model-value",o)}});function v(){e.value&&(d=e.value.addListener("click",y),p=e.value.addListener("mouseup",()=>{var f,c,s;const o=(s=(c=(f=e.value)==null?void 0:f.getPath())==null?void 0:c.getArray())==null?void 0:s.map(h=>h.toJSON());o&&(m.value=[...o])}))}function g(){d&&d.remove(),p&&p.remove()}function y(o){n("click",o)}return t.watch(()=>r.options,(o,f)=>{!e.value||O(o,f)||e.value.setOptions(r.options)},{deep:!0}),t.watch(m,(o,f)=>{O(o,f)||!e.value||!o||e.value.setPath(o)}),l({polygon:e}),t.onBeforeUnmount(()=>{g(),e.value&&(e.value.setMap(null),e.value=null)}),()=>{var o;return(o=i.default)==null?void 0:o.call(i)}}}),U=t.defineComponent({name:"VGooglePolyline",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","update:model-value"],setup(r,{emit:n,expose:l,slots:i}){const{gmapApi:a}=L(),u=t.inject("google-map");t.onMounted(()=>{if(u!=null&&u.value&&a.value){const o={...r.options};m.value&&(o.path=[...m.value]),e.value=t.markRaw(new a.value.maps.Polyline({...o,map:u.value})),v()}});const e=t.ref(null);let d=null,p=null;const m=t.computed({get(){return r.modelValue},set(o){n("update:model-value",o)}});function v(){e.value&&(d=e.value.addListener("click",y),p=e.value.addListener("mouseup",()=>{var f,c,s;const o=(s=(c=(f=e.value)==null?void 0:f.getPath())==null?void 0:c.getArray())==null?void 0:s.map(h=>h.toJSON());o&&(m.value=[...o])}))}function g(){d&&d.remove(),p&&p.remove()}function y(o){n("click",o)}return t.watch(()=>r.options,(o,f)=>{!e.value||O(o,f)||e.value.setOptions(r.options)},{deep:!0}),t.watch(m,(o,f)=>{O(o,f)||!e.value||!o||e.value.setPath(o)}),l({polyline:e}),t.onBeforeUnmount(()=>{g(),e.value&&(e.value.setMap(null),e.value=null)}),()=>{var o;return(o=i.default)==null?void 0:o.call(i)}}}),B=t.defineComponent({name:"VGoogleRectangle",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","update:model-value"],setup(r,{emit:n,expose:l,slots:i}){const{gmapApi:a}=L(),u=t.inject("google-map");t.onMounted(()=>{if(u!=null&&u.value&&a.value){const o={...r.options};m.value&&(o.bounds={...m.value}),e.value=t.markRaw(new a.value.maps.Rectangle({map:u.value,...o})),v()}});const e=t.ref(null);let d=null,p=null;const m=t.computed({get(){return r.modelValue},set(o){n("update:model-value",o)}});function v(){e.value&&(d=e.value.addListener("click",y),p=e.value.addListener("bounds_changed",()=>{var f,c;const o=(c=(f=e.value)==null?void 0:f.getBounds())==null?void 0:c.toJSON();o&&(m.value={...o})}))}function g(){d&&d.remove(),p&&p.remove()}function y(o){n("click",o)}return t.watch(()=>r.options,(o,f)=>{!e.value||O(o,f)||e.value.setOptions(r.options)},{deep:!0}),t.watch(m,(o,f)=>{O(o,f)||!e.value||!o||e.value.setBounds(o)}),l({rectangle:e}),t.onBeforeUnmount(()=>{g(),e.value&&(e.value.setMap(null),e.value=null)}),()=>{var o;return(o=i.default)==null?void 0:o.call(i)}}}),$={key:0,class:"v-google-info-window__container"},q=t.defineComponent({__name:"VGoogleInfoWindow",props:{options:{default:null,type:Object},modelValue:{type:Boolean,default:null}},emits:["click","update:model-value"],setup(r,{expose:n,emit:l}){const i=r,a=t.useSlots(),{gmapApi:u}=L(),e=t.inject("google-map"),d=t.inject("marker",t.ref(null));t.onMounted(()=>{var k;u.value&&(v.value=t.markRaw(new u.value.maps.InfoWindow({...i.options,content:o.value?m.value:(k=i.options)==null?void 0:k.content})),c(),f.value&&h())});const p=t.ref(!1),m=t.ref(),v=t.ref(null);let g=null,y=null;const o=t.computed(()=>{var k;return(k=a.default)==null?void 0:k.call(a).some(w=>w.type!==Comment)}),f=t.computed({get(){return i.modelValue},set(k){l("update:model-value",k)}});function c(){var k;!(d!=null&&d.value)||!v.value||(y=(k=d.value)==null?void 0:k.addListener("click",h),g=v.value.addListener("closeclick",h))}function s(){y&&y.remove(),g&&g.remove()}function h(){!v.value||!(e!=null&&e.value)||(p.value=!p.value,p.value?v.value.open({map:e.value,anchor:d==null?void 0:d.value}):v.value.close(),f.value=p.value)}return t.watch(()=>i.options,(k,w)=>{!v.value||O(k,w)||v.value.setOptions(i.options)},{deep:!0}),t.watch(f,k=>{k===null||k===p.value||h()}),n({infoWindow:v}),t.onBeforeUnmount(()=>{s(),v.value&&(v.value.close(),v.value=null)}),(k,w)=>t.unref(o)?(t.openBlock(),t.createElementBlock("div",$,[t.createElementVNode("div",{ref_key:"infoWindowRef",ref:m},[t.renderSlot(k.$slots,"default",{},void 0,!0)],512)])):t.createCommentVNode("",!0)}});const x=I(q,[["__scopeId","data-v-2f6a5bf7"]]),D=r=>{r.component("VGoogleMap",V),r.component("VGoogleCircle",A),r.component("VGoogleMarker",E),r.component("VGoogleHeatmap",P),r.component("VGooglePolygon",N),r.component("VGooglePolyline",U),r.component("VGoogleRectangle",B),r.component("VGoogleInfoWindow",x)};exports.useGmapLoader=L;exports.vGoogleMaps=D;
