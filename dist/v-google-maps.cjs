"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const l=require("vue");/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function se(i,e,t,n){function o(s){return s instanceof t?s:new t(function(r){r(s)})}return new(t||(t=Promise))(function(s,r){function u(c){try{p(n.next(c))}catch(h){r(h)}}function a(c){try{p(n.throw(c))}catch(h){r(h)}}function p(c){c.done?s(c.value):o(c.value).then(u,a)}p((n=n.apply(i,e||[])).next())})}var ie=function i(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,o,s;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(o=n;o--!==0;)if(!i(e[o],t[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[o]))return!1;for(o=n;o--!==0;){var r=s[o];if(!i(e[r],t[r]))return!1}return!0}return e!==e&&t!==t};const H="__googleMapsScriptId";var P;(function(i){i[i.INITIALIZED=0]="INITIALIZED",i[i.LOADING=1]="LOADING",i[i.SUCCESS=2]="SUCCESS",i[i.FAILURE=3]="FAILURE"})(P||(P={}));class x{constructor({apiKey:e,authReferrerPolicy:t,channel:n,client:o,id:s=H,language:r,libraries:u=[],mapIds:a,nonce:p,region:c,retries:h=3,url:y="https://maps.googleapis.com/maps/api/js",version:d}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=e,this.authReferrerPolicy=t,this.channel=n,this.client=o,this.id=s||H,this.language=r,this.libraries=u,this.mapIds=a,this.nonce=p,this.region=c,this.retries=h,this.url=y,this.version=d,x.instance){if(!ie(this.options,x.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(x.instance.options)}`);return x.instance}x.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?P.FAILURE:this.done?P.SUCCESS:this.loading?P.LOADING:P.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+="?callback=__googleMapsCallback",this.apiKey&&(e+=`&key=${this.apiKey}`),this.channel&&(e+=`&channel=${this.channel}`),this.client&&(e+=`&client=${this.client}`),this.libraries.length>0&&(e+=`&libraries=${this.libraries.join(",")}`),this.language&&(e+=`&language=${this.language}`),this.region&&(e+=`&region=${this.region}`),this.version&&(e+=`&v=${this.version}`),this.mapIds&&(e+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(e+=`&auth_referrer_policy=${this.authReferrerPolicy}`),e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((e,t)=>{this.loadCallback(n=>{n?t(n.error):e(window.google)})})}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,t;if(document.getElementById(this.id)){this.callback();return}const n={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(n).forEach(s=>!n[s]&&delete n[s]),!((t=(e=window==null?void 0:window.google)===null||e===void 0?void 0:e.maps)===null||t===void 0)&&t.importLibrary||(s=>{let r,u,a,p="The Google Maps JavaScript API",c="google",h="importLibrary",y="__ib__",d=document,g=window;g=g[c]||(g[c]={});const f=g.maps||(g.maps={}),m=new Set,v=new URLSearchParams,w=()=>r||(r=new Promise((k,L)=>se(this,void 0,void 0,function*(){var O;yield u=d.createElement("script"),u.id=this.id,v.set("libraries",[...m]+"");for(a in s)v.set(a.replace(/[A-Z]/g,N=>"_"+N[0].toLowerCase()),s[a]);v.set("callback",c+".maps."+y),u.src=this.url+"?"+v,f[y]=k,u.onerror=()=>r=L(Error(p+" could not load.")),u.nonce=this.nonce||((O=d.querySelector("script[nonce]"))===null||O===void 0?void 0:O.nonce)||"",d.head.append(u)})));f[h]?console.warn(p+" only loads once. Ignoring:",s):f[h]=(k,...L)=>m.add(k)&&w().then(()=>f[h](k,...L))})(n);const o=this.libraries.map(s=>this.importLibrary(s));o.length||o.push(this.importLibrary("core")),Promise.all(o).then(()=>this.callback(),s=>{const r=new ErrorEvent("error",{error:s});this.loadErrorCallback(r)})}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){const t=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${t} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},t)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading||(this.loading=!0,this.setScript())}}}const F=l.ref(null);async function ae(i,e=[]){if(F.value)return;const t=new x({apiKey:i,libraries:e});F.value=await t.load()}function C(){return{gmapApi:F,load:ae}}function le(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var ue=function i(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,o,s;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(o=n;o--!==0;)if(!i(e[o],t[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[o]))return!1;for(o=n;o--!==0;){var r=s[o];if(!i(e[r],t[r]))return!1}return!0}return e!==e&&t!==t};const _=le(ue),b=Symbol("map"),X=Symbol("marker"),ee=Symbol("marker-clusterer"),ce={class:"v-google-map__wrapper"},he=l.defineComponent({__name:"VGoogleMap",props:{width:{required:!0,type:String},height:{required:!0,type:String},borderRadius:{default:"initial",type:String},options:{required:!0,type:Object},center:{default:null,type:Object},zoom:{default:null,type:Number}},emits:["ready","click","update:zoom","update:center"],setup(i,{expose:e,emit:t}){const n=i;l.useCssVars(m=>({"4fc8e44e":i.width,11873374:i.height,"5a101f2a":i.borderRadius}));const{gmapApi:o}=C(),s=l.ref(!1),r=l.ref(null),u=l.ref(null);let a=null,p=null,c=null;l.provide(b,r);const h=l.computed({get(){return n.center},set(m){t("update:center",m)}}),y=l.computed({get(){return n.zoom},set(m){t("update:zoom",m)}});l.onMounted(async()=>{if(!u.value||!o.value)return;const m={...n.options};h.value&&(m.center={...h.value}),y.value&&(m.zoom=y.value),r.value=l.markRaw(new o.value.maps.Map(u.value,{...m})),s.value=!0,await l.nextTick(),d(),t("ready")});function d(){r.value&&(a=r.value.addListener("click",f),p=r.value.addListener("dragend",()=>{var m,v;h.value=((v=(m=r.value)==null?void 0:m.getCenter())==null?void 0:v.toJSON())??null}),c=r.value.addListener("zoom_changed",()=>{var m;y.value=((m=r.value)==null?void 0:m.getZoom())??0}))}function g(){a&&a.remove(),p&&p.remove(),c&&c.remove()}function f(m){t("click",m)}return l.watch(()=>n.options,(m,v)=>{!r.value||_(m,v)||r.value.setOptions(n.options)},{deep:!0}),l.watch(h,(m,v)=>{_(m,v)||!r.value||!m||r.value.setCenter({...m})}),l.watch(y,(m,v)=>{_(m,v)||!r.value||!m||r.value.setZoom(m)}),e({map:r}),l.onBeforeUnmount(()=>{g(),r.value=null}),(m,v)=>(l.openBlock(),l.createElementBlock("div",ce,[l.createElementVNode("div",{class:"v-google-map__container",ref_key:"mapRef",ref:u},null,512),s.value?l.renderSlot(m.$slots,"default",{key:0},void 0,!0):l.createCommentVNode("",!0)]))}});const te=(i,e)=>{const t=i.__vccOpts||i;for(const[n,o]of e)t[n]=o;return t},de=te(he,[["__scopeId","data-v-52ac4172"]]),pe=l.defineComponent({name:"VGoogleCircle",props:{options:{required:!0,type:Object},center:{default:null,type:Object},radius:{default:null,type:Number}},emits:["click","update:center","update:radius"],setup(i,{emit:e,expose:t,slots:n}){const{gmapApi:o}=C(),s=l.inject(b,l.ref(null));l.onMounted(()=>{if(s.value&&o.value){const f={...i.options};c.value&&(f.center={...c.value}),h.value&&(f.radius=h.value),r.value=l.markRaw(new o.value.maps.Circle({map:s.value,...f})),y()}});const r=l.ref(null);let u=null,a=null,p=null;const c=l.computed({get(){return i.center},set(f){e("update:center",f)}}),h=l.computed({get(){return i.radius},set(f){e("update:radius",f)}});function y(){r.value&&(u=r.value.addListener("click",g),a=r.value.addListener("radius_changed",()=>{var f;h.value=((f=r.value)==null?void 0:f.getRadius())??null}),p=r.value.addListener("center_changed",()=>{var m,v;const f=(v=(m=r.value)==null?void 0:m.getCenter())==null?void 0:v.toJSON();f&&(c.value={...f})}))}function d(){u&&u.remove(),a&&a.remove(),p&&p.remove()}function g(f){e("click",f)}return l.watch(()=>i.options,(f,m)=>{!r.value||_(f,m)||r.value.setOptions(i.options)},{deep:!0}),l.watch(c,(f,m)=>{_(f,m)||!r.value||!f||r.value.setCenter({...f})}),l.watch(h,(f,m)=>{_(f,m)||!r.value||!f||r.value.setRadius(f)}),t({circle:r}),l.onBeforeUnmount(()=>{d(),r.value&&(r.value.setMap(null),r.value=null)}),()=>{var f;return(f=n.default)==null?void 0:f.call(n)}}}),fe=l.defineComponent({name:"VGoogleMarker",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","update:model-value"],setup(i,{emit:e,expose:t,slots:n}){const{gmapApi:o}=C(),s=l.inject(b,l.ref(null)),r=l.inject(ee,l.ref(null)),u=l.ref(null);let a=null,p=null;if(s.value&&o.value){const g={...i.options};i.modelValue&&(g.position={...i.modelValue}),u.value=l.markRaw(new o.value.maps.Marker({map:r.value===null?s.value:null,...g})),r.value&&r.value.addMarker(u.value),h()}const c=l.computed({get(){return i.modelValue},set(g){e("update:model-value",g)}});function h(){u.value&&(a=u.value.addListener("click",d),p=u.value.addListener("mouseup",()=>{var g,f;c.value=((f=(g=u.value)==null?void 0:g.getPosition())==null?void 0:f.toJSON())??null}))}function y(){a&&a.remove(),p&&p.remove()}function d(g){e("click",g)}return l.watch(()=>i.options,(g,f)=>{!u.value||_(g,f)||u.value.setOptions(i.options)},{deep:!0}),l.watch(c,(g,f)=>{_(g,f)||!u.value||u.value.setPosition(g)}),t({marker:u}),l.provide(X,u),l.onBeforeUnmount(()=>{y(),u.value&&(r.value&&r.value.removeMarker(u.value),u.value.setMap(null),u.value=null)}),()=>{var g;return(g=n.default)==null?void 0:g.call(n)}}}),me=l.defineComponent({name:"VGoogleHeatmap",props:{options:{required:!0,type:Object}},setup(i,{expose:e,slots:t}){const{gmapApi:n}=C(),o=l.inject(b,l.ref(null));l.onMounted(()=>{if(o.value&&n.value){const r={...i.options};s.value=l.markRaw(new n.value.maps.visualization.HeatmapLayer({map:o.value,...r}))}});const s=l.ref(null);return l.watch(()=>i.options,(r,u)=>{!s.value||_(r,u)||s.value.setOptions(i.options)},{deep:!0}),l.onUnmounted(()=>{s.value&&(s.value.setMap(null),s.value=null)}),e({heatmap:s}),()=>{var r;return(r=t.default)==null?void 0:r.call(t)}}}),ge=l.defineComponent({name:"VGooglePolygon",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","mouseover","mouseout","update:model-value"],setup(i,{emit:e,expose:t,slots:n}){const{gmapApi:o}=C(),s=l.inject(b,l.ref(null));l.onMounted(()=>{if(s.value&&o.value){const v={...i.options};h.value&&(v.paths=[...h.value]),r.value=l.markRaw(new o.value.maps.Polygon({map:s.value,...v})),y()}});const r=l.ref(null);let u=null,a=null,p=null,c=null;const h=l.computed({get(){return i.modelValue},set(v){e("update:model-value",v)}});function y(){r.value&&(u=r.value.addListener("click",g),p=r.value.addListener("mouseout",m),c=r.value.addListener("mouseover",f),a=r.value.addListener("mouseup",()=>{var w,k,L;const v=(L=(k=(w=r.value)==null?void 0:w.getPath())==null?void 0:k.getArray())==null?void 0:L.map(O=>O.toJSON());v&&(h.value=[...v])}))}function d(){u&&u.remove(),a&&a.remove(),p&&p.remove(),c&&c.remove()}function g(v){e("click",v)}function f(v){e("mouseover",v)}function m(v){e("mouseout",v)}return l.watch(()=>i.options,(v,w)=>{!r.value||_(v,w)||r.value.setOptions(i.options)},{deep:!0}),l.watch(h,(v,w)=>{_(v,w)||!r.value||!v||r.value.setPath(v)}),t({polygon:r}),l.onBeforeUnmount(()=>{d(),r.value&&(r.value.setMap(null),r.value=null)}),()=>{var v;return(v=n.default)==null?void 0:v.call(n)}}}),ve=l.defineComponent({name:"VGooglePolyline",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","update:model-value"],setup(i,{emit:e,expose:t,slots:n}){const{gmapApi:o}=C(),s=l.inject(b,l.ref(null));l.onMounted(()=>{if(s.value&&o.value){const d={...i.options};p.value&&(d.path=[...p.value]),r.value=l.markRaw(new o.value.maps.Polyline({...d,map:s.value})),c()}});const r=l.ref(null);let u=null,a=null;const p=l.computed({get(){return i.modelValue},set(d){e("update:model-value",d)}});function c(){r.value&&(u=r.value.addListener("click",y),a=r.value.addListener("mouseup",()=>{var g,f,m;const d=(m=(f=(g=r.value)==null?void 0:g.getPath())==null?void 0:f.getArray())==null?void 0:m.map(v=>v.toJSON());d&&(p.value=[...d])}))}function h(){u&&u.remove(),a&&a.remove()}function y(d){e("click",d)}return l.watch(()=>i.options,(d,g)=>{!r.value||_(d,g)||r.value.setOptions(i.options)},{deep:!0}),l.watch(p,(d,g)=>{_(d,g)||!r.value||!d||r.value.setPath(d)}),t({polyline:r}),l.onBeforeUnmount(()=>{h(),r.value&&(r.value.setMap(null),r.value=null)}),()=>{var d;return(d=n.default)==null?void 0:d.call(n)}}}),ye=l.defineComponent({name:"VGoogleRectangle",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","update:model-value"],setup(i,{emit:e,expose:t,slots:n}){const{gmapApi:o}=C(),s=l.inject(b,l.ref(null));l.onMounted(()=>{if(s.value&&o.value){const d={...i.options};p.value&&(d.bounds={...p.value}),r.value=l.markRaw(new o.value.maps.Rectangle({map:s.value,...d})),c()}});const r=l.ref(null);let u=null,a=null;const p=l.computed({get(){return i.modelValue},set(d){e("update:model-value",d)}});function c(){r.value&&(u=r.value.addListener("click",y),a=r.value.addListener("bounds_changed",()=>{var g,f;const d=(f=(g=r.value)==null?void 0:g.getBounds())==null?void 0:f.toJSON();d&&(p.value={...d})}))}function h(){u&&u.remove(),a&&a.remove()}function y(d){e("click",d)}return l.watch(()=>i.options,(d,g)=>{!r.value||_(d,g)||r.value.setOptions(i.options)},{deep:!0}),l.watch(p,(d,g)=>{_(d,g)||!r.value||!d||r.value.setBounds(d)}),t({rectangle:r}),l.onBeforeUnmount(()=>{h(),r.value&&(r.value.setMap(null),r.value=null)}),()=>{var d;return(d=n.default)==null?void 0:d.call(n)}}}),we={key:0,class:"v-google-info-window__container"},ke=l.defineComponent({__name:"VGoogleInfoWindow",props:{options:{default:null,type:Object},modelValue:{type:Boolean,default:null}},emits:["click","update:model-value"],setup(i,{expose:e,emit:t}){const n=i,o=l.useSlots(),{gmapApi:s}=C(),r=l.inject(b,l.ref(null)),u=l.inject(X,l.ref(null));l.onMounted(()=>{var w;s.value&&(c.value=l.markRaw(new s.value.maps.InfoWindow({...n.options,content:d.value?p.value:(w=n.options)==null?void 0:w.content})),f(),g.value&&v())});const a=l.ref(!1),p=l.ref(),c=l.ref(null);let h=null,y=null;const d=l.computed(()=>{var w;return(w=o.default)==null?void 0:w.call(o).some(k=>k.type!==Comment)}),g=l.computed({get(){return n.modelValue},set(w){t("update:model-value",w)}});function f(){!u.value||!c.value||(y=u.value.addListener("click",v),h=c.value.addListener("closeclick",v))}function m(){y&&y.remove(),h&&h.remove()}function v(){!c.value||!r.value||(a.value=!a.value,a.value?c.value.open({map:r.value,anchor:u.value}):c.value.close(),g.value=a.value)}return l.watch(()=>n.options,(w,k)=>{!c.value||_(w,k)||c.value.setOptions(n.options)},{deep:!0}),l.watch(g,w=>{w===null||w===a.value||v()}),e({infoWindow:c}),l.onBeforeUnmount(()=>{m(),c.value&&(c.value.close(),c.value=null)}),(w,k)=>d.value?(l.openBlock(),l.createElementBlock("div",we,[l.createElementVNode("div",{ref_key:"infoWindowRef",ref:p},[l.renderSlot(w.$slots,"default",{},void 0,!0)],512)])):l.createCommentVNode("",!0)}});const _e=te(ke,[["__scopeId","data-v-e43ab925"]]),K=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],V=1,j=8;class q{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,n]=new Uint8Array(e,0,2);if(t!==219)throw new Error("Data does not appear to be in a KDBush format.");const o=n>>4;if(o!==V)throw new Error(`Got v${o} data when expected v${V}.`);const s=K[n&15];if(!s)throw new Error("Unrecognized array type.");const[r]=new Uint16Array(e,2,1),[u]=new Uint32Array(e,4,1);return new q(u,r,s,e)}constructor(e,t=64,n=Float64Array,o){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const s=K.indexOf(this.ArrayType),r=e*2*this.ArrayType.BYTES_PER_ELEMENT,u=e*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-u%8)%8;if(s<0)throw new Error(`Unexpected typed array class: ${n}.`);o&&o instanceof ArrayBuffer?(this.data=o,this.ids=new this.IndexArrayType(this.data,j,e),this.coords=new this.ArrayType(this.data,j+u+a,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(j+r+u+a),this.ids=new this.IndexArrayType(this.data,j,e),this.coords=new this.ArrayType(this.data,j+u+a,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(V<<4)+s]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=t,n}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return $(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,n,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:r,nodeSize:u}=this,a=[0,s.length-1,0],p=[];for(;a.length;){const c=a.pop()||0,h=a.pop()||0,y=a.pop()||0;if(h-y<=u){for(let m=y;m<=h;m++){const v=r[2*m],w=r[2*m+1];v>=e&&v<=n&&w>=t&&w<=o&&p.push(s[m])}continue}const d=y+h>>1,g=r[2*d],f=r[2*d+1];g>=e&&g<=n&&f>=t&&f<=o&&p.push(s[d]),(c===0?e<=g:t<=f)&&(a.push(y),a.push(d-1),a.push(1-c)),(c===0?n>=g:o>=f)&&(a.push(d+1),a.push(h),a.push(1-c))}return p}within(e,t,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:o,coords:s,nodeSize:r}=this,u=[0,o.length-1,0],a=[],p=n*n;for(;u.length;){const c=u.pop()||0,h=u.pop()||0,y=u.pop()||0;if(h-y<=r){for(let m=y;m<=h;m++)W(s[2*m],s[2*m+1],e,t)<=p&&a.push(o[m]);continue}const d=y+h>>1,g=s[2*d],f=s[2*d+1];W(g,f,e,t)<=p&&a.push(o[d]),(c===0?e-n<=g:t-n<=f)&&(u.push(y),u.push(d-1),u.push(1-c)),(c===0?e+n>=g:t+n>=f)&&(u.push(d+1),u.push(h),u.push(1-c))}return a}}function $(i,e,t,n,o,s){if(o-n<=t)return;const r=n+o>>1;ne(i,e,r,n,o,s),$(i,e,t,n,r-1,1-s),$(i,e,t,r+1,o,1-s)}function ne(i,e,t,n,o,s){for(;o>n;){if(o-n>600){const p=o-n+1,c=t-n+1,h=Math.log(p),y=.5*Math.exp(2*h/3),d=.5*Math.sqrt(h*y*(p-y)/p)*(c-p/2<0?-1:1),g=Math.max(n,Math.floor(t-c*y/p+d)),f=Math.min(o,Math.floor(t+(p-c)*y/p+d));ne(i,e,t,g,f,s)}const r=e[2*t+s];let u=n,a=o;for(R(i,e,n,t),e[2*o+s]>r&&R(i,e,n,o);u<a;){for(R(i,e,u,a),u++,a--;e[2*u+s]<r;)u++;for(;e[2*a+s]>r;)a--}e[2*n+s]===r?R(i,e,n,a):(a++,R(i,e,a,o)),a<=t&&(n=a+1),t<=a&&(o=a-1)}}function R(i,e,t,n){Z(i,t,n),Z(e,2*t,2*n),Z(e,2*t+1,2*n+1)}function Z(i,e,t){const n=i[e];i[e]=i[t],i[t]=n}function W(i,e,t,n){const o=i-t,s=e-n;return o*o+s*s}const Me={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:i=>i},Y=Math.fround||(i=>e=>(i[0]=+e,i[0]))(new Float32Array(1)),I=2,A=3,B=4,E=5,re=6;class Le{constructor(e){this.options=Object.assign(Object.create(Me),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:n,maxZoom:o}=this.options;t&&console.time("total time");const s=`prepare ${e.length} points`;t&&console.time(s),this.points=e;const r=[];for(let a=0;a<e.length;a++){const p=e[a];if(!p.geometry)continue;const[c,h]=p.geometry.coordinates,y=Y(T(c)),d=Y(U(h));r.push(y,d,1/0,a,-1,1),this.options.reduce&&r.push(0)}let u=this.trees[o+1]=this._createTree(r);t&&console.timeEnd(s);for(let a=o;a>=n;a--){const p=+Date.now();u=this.trees[a]=this._createTree(this._cluster(u,a)),t&&console.log("z%d: %d clusters in %dms",a,u.numItems,+Date.now()-p)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let n=((e[0]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,e[1]));let s=e[2]===180?180:((e[2]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,s=180;else if(n>s){const h=this.getClusters([n,o,180,r],t),y=this.getClusters([-180,o,s,r],t);return h.concat(y)}const u=this.trees[this._limitZoom(t)],a=u.range(T(n),U(r),T(s),U(o)),p=u.data,c=[];for(const h of a){const y=this.stride*h;c.push(p[y+E]>1?Q(p,y,this.clusterProps):this.points[p[y+A]])}return c}getChildren(e){const t=this._getOriginId(e),n=this._getOriginZoom(e),o="No cluster with the specified id.",s=this.trees[n];if(!s)throw new Error(o);const r=s.data;if(t*this.stride>=r.length)throw new Error(o);const u=this.options.radius/(this.options.extent*Math.pow(2,n-1)),a=r[t*this.stride],p=r[t*this.stride+1],c=s.within(a,p,u),h=[];for(const y of c){const d=y*this.stride;r[d+B]===e&&h.push(r[d+E]>1?Q(r,d,this.clusterProps):this.points[r[d+A]])}if(h.length===0)throw new Error(o);return h}getLeaves(e,t,n){t=t||10,n=n||0;const o=[];return this._appendLeaves(o,e,t,n,0),o}getTile(e,t,n){const o=this.trees[this._limitZoom(e)],s=Math.pow(2,e),{extent:r,radius:u}=this.options,a=u/r,p=(n-a)/s,c=(n+1+a)/s,h={features:[]};return this._addTileFeatures(o.range((t-a)/s,p,(t+1+a)/s,c),o.data,t,n,s,h),t===0&&this._addTileFeatures(o.range(1-a/s,p,1,c),o.data,s,n,s,h),t===s-1&&this._addTileFeatures(o.range(0,p,a/s,c),o.data,-1,n,s,h),h.features.length?h:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const n=this.getChildren(e);if(t++,n.length!==1)break;e=n[0].properties.cluster_id}return t}_appendLeaves(e,t,n,o,s){const r=this.getChildren(t);for(const u of r){const a=u.properties;if(a&&a.cluster?s+a.point_count<=o?s+=a.point_count:s=this._appendLeaves(e,a.cluster_id,n,o,s):s<o?s++:e.push(u),e.length===n)break}return s}_createTree(e){const t=new q(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let n=0;n<e.length;n+=this.stride)t.add(e[n],e[n+1]);return t.finish(),t.data=e,t}_addTileFeatures(e,t,n,o,s,r){for(const u of e){const a=u*this.stride,p=t[a+E]>1;let c,h,y;if(p)c=oe(t,a,this.clusterProps),h=t[a],y=t[a+1];else{const f=this.points[t[a+A]];c=f.properties;const[m,v]=f.geometry.coordinates;h=T(m),y=U(v)}const d={type:1,geometry:[[Math.round(this.options.extent*(h*s-n)),Math.round(this.options.extent*(y*s-o))]],tags:c};let g;p||this.options.generateId?g=t[a+A]:g=this.points[t[a+A]].id,g!==void 0&&(d.id=g),r.features.push(d)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:n,extent:o,reduce:s,minPoints:r}=this.options,u=n/(o*Math.pow(2,t)),a=e.data,p=[],c=this.stride;for(let h=0;h<a.length;h+=c){if(a[h+I]<=t)continue;a[h+I]=t;const y=a[h],d=a[h+1],g=e.within(a[h],a[h+1],u),f=a[h+E];let m=f;for(const v of g){const w=v*c;a[w+I]>t&&(m+=a[w+E])}if(m>f&&m>=r){let v=y*f,w=d*f,k,L=-1;const O=((h/c|0)<<5)+(t+1)+this.points.length;for(const N of g){const S=N*c;if(a[S+I]<=t)continue;a[S+I]=t;const J=a[S+E];v+=a[S]*J,w+=a[S+1]*J,a[S+B]=O,s&&(k||(k=this._map(a,h,!0),L=this.clusterProps.length,this.clusterProps.push(k)),s(k,this._map(a,S)))}a[h+B]=O,p.push(v/m,w/m,1/0,O,-1,m),s&&p.push(L)}else{for(let v=0;v<c;v++)p.push(a[h+v]);if(m>1)for(const v of g){const w=v*c;if(!(a[w+I]<=t)){a[w+I]=t;for(let k=0;k<c;k++)p.push(a[w+k])}}}}return p}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,n){if(e[t+E]>1){const r=this.clusterProps[e[t+re]];return n?Object.assign({},r):r}const o=this.points[e[t+A]].properties,s=this.options.map(o);return n&&s===o?Object.assign({},s):s}}function Q(i,e,t){return{type:"Feature",id:i[e+A],properties:oe(i,e,t),geometry:{type:"Point",coordinates:[Oe(i[e]),Ce(i[e+1])]}}}function oe(i,e,t){const n=i[e+E],o=n>=1e4?`${Math.round(n/1e3)}k`:n>=1e3?`${Math.round(n/100)/10}k`:n,s=i[e+re],r=s===-1?{}:Object.assign({},t[s]);return Object.assign(r,{cluster:!0,cluster_id:i[e+A],point_count:n,point_count_abbreviated:o})}function T(i){return i/360+.5}function U(i){const e=Math.sin(i*Math.PI/180),t=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return t<0?0:t>1?1:t}function Oe(i){return(i-.5)*360}function Ce(i){const e=(180-i*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function be(i,e){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(i);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(i,n[o])&&(t[n[o]]=i[n[o]]);return t}class M{static isAdvancedMarkerAvailable(e){return google.maps.marker&&e.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,t){this.isAdvancedMarker(e)?e.map=t:e.setMap(t)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return this.isAdvancedMarker(e)?!0:e.getVisible()}}class D{constructor({markers:e,position:t}){this.markers=e,t&&(t instanceof google.maps.LatLng?this._position=t:this._position=new google.maps.LatLng(t))}get bounds(){if(this.markers.length===0&&!this._position)return;const e=new google.maps.LatLngBounds(this._position,this._position);for(const t of this.markers)e.extend(M.getPosition(t));return e}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>M.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(M.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class Ee{constructor({maxZoom:e=16}){this.maxZoom=e}noop({markers:e}){return Ae(e)}}const Ae=i=>i.map(t=>new D({position:M.getPosition(t),markers:[t]}));class Se extends Ee{constructor(e){var{maxZoom:t,radius:n=60}=e,o=be(e,["maxZoom","radius"]);super({maxZoom:t}),this.state={zoom:-1},this.superCluster=new Le(Object.assign({maxZoom:this.maxZoom,radius:n},o))}calculate(e){let t=!1;const n={zoom:e.map.getZoom()};if(!_(e.markers,this.markers)){t=!0,this.markers=[...e.markers];const o=this.markers.map(s=>{const r=M.getPosition(s);return{type:"Feature",geometry:{type:"Point",coordinates:[r.lng(),r.lat()]},properties:{marker:s}}});this.superCluster.load(o)}return t||(this.state.zoom<=this.maxZoom||n.zoom<=this.maxZoom)&&(t=!_(this.state,n)),this.state=n,t&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:t}}cluster({map:e}){return this.superCluster.getClusters([-180,-90,180,90],Math.round(e.getZoom())).map(t=>this.transformCluster(t))}transformCluster({geometry:{coordinates:[e,t]},properties:n}){if(n.cluster)return new D({markers:this.superCluster.getLeaves(n.cluster_id,1/0).map(s=>s.properties.marker),position:{lat:t,lng:e}});const o=n.marker;return new D({markers:[o],position:M.getPosition(o)})}}class Ie{constructor(e,t){this.markers={sum:e.length};const n=t.map(s=>s.count),o=n.reduce((s,r)=>s+r,0);this.clusters={count:t.length,markers:{mean:o/t.length,sum:o,min:Math.min(...n),max:Math.max(...n)}}}}class xe{render({count:e,position:t},n,o){const r=`<svg fill="${e>Math.max(10,n.clusters.markers.mean)?"#ff0000":"#0000ff"}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">${e}</text>
</svg>`,u=`Cluster of ${e} markers`,a=Number(google.maps.Marker.MAX_ZINDEX)+e;if(M.isAdvancedMarkerAvailable(o)){const c=document.createElement("div");c.innerHTML=r;const h=c.firstElementChild;h.setAttribute("transform","translate(0 25)");const y={map:o,position:t,zIndex:a,title:u,content:h};return new google.maps.marker.AdvancedMarkerElement(y)}const p={position:t,zIndex:a,title:u,icon:{url:`data:image/svg+xml;base64,${btoa(r)}`,anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(p)}}function Pe(i,e){for(let t in e.prototype)i.prototype[t]=e.prototype[t]}class z{constructor(){Pe(z,google.maps.OverlayView)}}var G;(function(i){i.CLUSTERING_BEGIN="clusteringbegin",i.CLUSTERING_END="clusteringend",i.CLUSTER_CLICK="click"})(G||(G={}));const je=(i,e,t)=>{t.fitBounds(e.bounds)};class Re extends z{constructor({map:e,markers:t=[],algorithmOptions:n={},algorithm:o=new Se(n),renderer:s=new xe,onClusterClick:r=je}){super(),this.markers=[...t],this.clusters=[],this.algorithm=o,this.renderer=s,this.onClusterClick=r,e&&this.setMap(e)}addMarker(e,t){this.markers.includes(e)||(this.markers.push(e),t||this.render())}addMarkers(e,t){e.forEach(n=>{this.addMarker(n,!0)}),t||this.render()}removeMarker(e,t){const n=this.markers.indexOf(e);return n===-1?!1:(M.setMap(e,null),this.markers.splice(n,1),t||this.render(),!0)}removeMarkers(e,t){let n=!1;return e.forEach(o=>{n=this.removeMarker(o,!0)||n}),n&&!t&&this.render(),n}clearMarkers(e){this.markers.length=0,e||this.render()}render(){const e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,G.CLUSTERING_BEGIN,this);const{clusters:t,changed:n}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(n||n==null){const o=new Set;for(const r of t)r.markers.length==1&&o.add(r.markers[0]);const s=[];for(const r of this.clusters)r.marker!=null&&(r.markers.length==1?o.has(r.marker)||M.setMap(r.marker,null):s.push(r.marker));this.clusters=t,this.renderClusters(),requestAnimationFrame(()=>s.forEach(r=>M.setMap(r,null)))}google.maps.event.trigger(this,G.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>M.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){const e=new Ie(this.markers,this.clusters),t=this.getMap();this.clusters.forEach(n=>{n.markers.length===1?n.marker=n.markers[0]:(n.marker=this.renderer.render(n,e,t),n.markers.forEach(o=>M.setMap(o,null)),this.onClusterClick&&n.marker.addListener("click",o=>{google.maps.event.trigger(this,G.CLUSTER_CLICK,n),this.onClusterClick(o,n,t)})),M.setMap(n.marker,t)})}}const Ge=l.defineComponent({name:"VGoogleMarkerClusterer",props:{options:{default:null,type:Object}},setup(i,{slots:e}){const t=l.inject(b,l.ref(null)),n=l.ref(null);return t.value&&(n.value=l.markRaw(new Re({map:t.value,...i.options}))),l.provide(ee,n),l.onBeforeUnmount(()=>{n.value&&(n.value.setMap(null),n.value.clearMarkers(),n.value=null)}),()=>{var o;return(o=e.default)==null?void 0:o.call(e)}}});function Te(i){i.component("VGoogleMap",de),i.component("VGoogleCircle",pe),i.component("VGoogleMarker",fe),i.component("VGoogleHeatmap",me),i.component("VGooglePolygon",ge),i.component("VGooglePolyline",ve),i.component("VGoogleRectangle",ye),i.component("VGoogleInfoWindow",_e),i.component("VGoogleMarkerClusterer",Ge)}exports.useGmapLoader=C;exports.vGoogleMaps=Te;
