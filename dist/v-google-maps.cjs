"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("vue");var G=function i(n,l){if(n===l)return!0;if(n&&l&&typeof n=="object"&&typeof l=="object"){if(n.constructor!==l.constructor)return!1;var u,s,a;if(Array.isArray(n)){if(u=n.length,u!=l.length)return!1;for(s=u;s--!==0;)if(!i(n[s],l[s]))return!1;return!0}if(n.constructor===RegExp)return n.source===l.source&&n.flags===l.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===l.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===l.toString();if(a=Object.keys(n),u=a.length,u!==Object.keys(l).length)return!1;for(s=u;s--!==0;)if(!Object.prototype.hasOwnProperty.call(l,a[s]))return!1;for(s=u;s--!==0;){var e=a[s];if(!i(n[e],l[e]))return!1}return!0}return n!==n&&l!==l};const j="__googleMapsScriptId";var w;(function(i){i[i.INITIALIZED=0]="INITIALIZED",i[i.LOADING=1]="LOADING",i[i.SUCCESS=2]="SUCCESS",i[i.FAILURE=3]="FAILURE"})(w||(w={}));class C{constructor({apiKey:n,authReferrerPolicy:l,channel:u,client:s,id:a=j,language:e,libraries:c=[],mapIds:p,nonce:v,region:f,retries:g=3,url:h="https://maps.googleapis.com/maps/api/js",version:o}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=n,this.authReferrerPolicy=l,this.channel=u,this.client=s,this.id=a||j,this.language=e,this.libraries=c,this.mapIds=p,this.nonce=v,this.region=f,this.retries=g,this.url=h,this.version=o,C.instance){if(!G(this.options,C.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(C.instance.options)}`);return C.instance}C.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?w.FAILURE:this.done?w.SUCCESS:this.loading?w.LOADING:w.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let n=this.url;return n+=`?callback=${this.CALLBACK}`,this.apiKey&&(n+=`&key=${this.apiKey}`),this.channel&&(n+=`&channel=${this.channel}`),this.client&&(n+=`&client=${this.client}`),this.libraries.length>0&&(n+=`&libraries=${this.libraries.join(",")}`),this.language&&(n+=`&language=${this.language}`),this.region&&(n+=`&region=${this.region}`),this.version&&(n+=`&v=${this.version}`),this.mapIds&&(n+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(n+=`&auth_referrer_policy=${this.authReferrerPolicy}`),n}deleteScript(){const n=document.getElementById(this.id);n&&n.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((n,l)=>{this.loadCallback(u=>{u?l(u.error):n(window.google)})})}loadCallback(n){this.callbacks.push(n),this.execute()}setScript(){if(document.getElementById(this.id)){this.callback();return}const n=this.createUrl(),l=document.createElement("script");l.id=this.id,l.type="text/javascript",l.src=n,l.onerror=this.loadErrorCallback.bind(this),l.defer=!0,l.async=!0,this.nonce&&(l.nonce=this.nonce),document.head.appendChild(l)}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(n){if(this.errors.push(n),this.errors.length<=this.retries){const l=this.errors.length*Math.pow(2,this.errors.length);console.log(`Failed to load Google Maps script, retrying in ${l} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},l)}else this.onerrorEvent=n,this.callback()}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(n=>{n(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version){console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),this.callback();return}this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}}const b=t.ref(null);async function S(i,n=[]){if(b.value)return;const l=new C({apiKey:i,libraries:n});b.value=await l.load()}function L(){return{gmapApi:b,load:S}}var k=function i(n,l){if(n===l)return!0;if(n&&l&&typeof n=="object"&&typeof l=="object"){if(n.constructor!==l.constructor)return!1;var u,s,a;if(Array.isArray(n)){if(u=n.length,u!=l.length)return!1;for(s=u;s--!==0;)if(!i(n[s],l[s]))return!1;return!0}if(n.constructor===RegExp)return n.source===l.source&&n.flags===l.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===l.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===l.toString();if(a=Object.keys(n),u=a.length,u!==Object.keys(l).length)return!1;for(s=u;s--!==0;)if(!Object.prototype.hasOwnProperty.call(l,a[s]))return!1;for(s=u;s--!==0;){var e=a[s];if(!i(n[e],l[e]))return!1}return!0}return n!==n&&l!==l};const R=t.defineComponent({__name:"VGoogleMap",props:{width:{required:!0,type:String},height:{required:!0,type:String},borderRadius:{default:"unset",type:String},options:{required:!0,type:Object},center:{default:null,type:Object},zoom:{default:null,type:Number}},emits:["ready","click","update:zoom","update:center"],setup(i,{emit:n}){const l=i;t.useCssVars(r=>({"3e550e08":i.width,"200aacb1":i.height,"2018c7e8":i.borderRadius}));const{gmapApi:u}=L(),s=t.ref(!1),a=t.ref(null),e=t.ref(null);let c=null,p=null,v=null;t.provide("google-map",a);const f=t.computed({get(){return l.center},set(r){n("update:center",r)}}),g=t.computed({get(){return l.zoom},set(r){n("update:zoom",r)}});t.onMounted(async()=>{if(!e.value||!u.value)return;const r={...l.options};f.value&&(r.center={...f.value}),g.value&&(r.zoom=g.value),a.value=t.markRaw(new u.value.maps.Map(e.value,{...r})),s.value=!0,await t.nextTick(),h(),n("ready")});function h(){a.value&&(c=a.value.addListener("click",d),p=a.value.addListener("dragend",()=>{var r,m;f.value=((m=(r=a.value)==null?void 0:r.getCenter())==null?void 0:m.toJSON())??null}),v=a.value.addListener("zoom_changed",()=>{var r;g.value=((r=a.value)==null?void 0:r.getZoom())??0}))}function o(){c&&c.remove(),p&&p.remove(),v&&v.remove()}function d(r){n("click",r)}return t.watch(()=>l.options,(r,m)=>{!a.value||k(r,m)||a.value.setOptions(l.options)},{deep:!0}),t.watch(f,(r,m)=>{k(r,m)||!a.value||!r||a.value.setCenter({...r})}),t.watch(g,(r,m)=>{k(r,m)||!a.value||!r||a.value.setZoom(r)}),t.onBeforeUnmount(()=>{o(),a.value=null}),(r,m)=>(t.openBlock(),t.createElementBlock("div",null,[t.createElementVNode("div",{class:"v-google-map__container",ref_key:"mapRef",ref:e},null,512),s.value?t.renderSlot(r.$slots,"default",{key:0},void 0,!0):t.createCommentVNode("",!0)]))}});const I=(i,n)=>{const l=i.__vccOpts||i;for(const[u,s]of n)l[u]=s;return l},M=I(R,[["__scopeId","data-v-028278a8"]]),V=t.defineComponent({name:"VGoogleCircle",props:{options:{required:!0,type:Object},center:{default:null,type:Object},radius:{default:null,type:Number}},emits:["click","update:center","update:radius"],setup(i,{emit:n,expose:l,slots:u}){const{gmapApi:s}=L(),a=t.inject("google-map");t.onMounted(()=>{if(a!=null&&a.value&&s.value){const r={...i.options};f.value&&(r.center={...f.value}),g.value&&(r.radius=g.value),e.value=t.markRaw(new s.value.maps.Circle({map:a.value,...r})),h()}});const e=t.ref(null);let c=null,p=null,v=null;const f=t.computed({get(){return i.center},set(r){n("update:center",r)}}),g=t.computed({get(){return i.radius},set(r){n("update:radius",r)}});function h(){e.value&&(c=e.value.addListener("click",d),p=e.value.addListener("radius_changed",()=>{var r;g.value=((r=e.value)==null?void 0:r.getRadius())??null}),v=e.value.addListener("center_changed",()=>{var m,O;const r=(O=(m=e.value)==null?void 0:m.getCenter())==null?void 0:O.toJSON();r&&(f.value={...r})}))}function o(){c&&c.remove(),p&&p.remove(),v&&v.remove()}function d(r){n("click",r)}return t.watch(()=>i.options,(r,m)=>{!e.value||k(r,m)||e.value.setOptions(i.options)},{deep:!0}),t.watch(f,(r,m)=>{k(r,m)||!e.value||!r||e.value.setCenter({...r})}),t.watch(g,(r,m)=>{k(r,m)||!e.value||!r||e.value.setRadius(r)}),l({circle:e}),t.onBeforeUnmount(()=>{o(),e.value&&(e.value.setMap(null),e.value=null)}),()=>{var r;return(r=u.default)==null?void 0:r.call(u)}}}),A=t.defineComponent({name:"VGoogleMarker",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","update:model-value"],setup(i,{emit:n,expose:l,slots:u}){const{gmapApi:s}=L(),a=t.inject("google-map"),e=t.ref(null);let c=null,p=null;if(a!=null&&a.value&&s.value){const o={...i.options};i.modelValue&&(o.position={...i.modelValue}),e.value=t.markRaw(new s.value.maps.Marker({map:a.value,...o})),f()}const v=t.computed({get(){return i.modelValue},set(o){n("update:model-value",o)}});function f(){e.value&&(c=e.value.addListener("click",h),p=e.value.addListener("mouseup",()=>{var o,d;v.value=((d=(o=e.value)==null?void 0:o.getPosition())==null?void 0:d.toJSON())??null}))}function g(){c&&c.remove(),p&&p.remove()}function h(o){n("click",o)}return t.watch(()=>i.options,(o,d)=>{!e.value||k(o,d)||e.value.setOptions(i.options)},{deep:!0}),t.watch(v,(o,d)=>{k(o,d)||!e.value||e.value.setPosition(o)}),l({marker:e}),t.provide("marker",e),t.onBeforeUnmount(()=>{g(),e.value&&(e.value.setMap(null),e.value=null)}),()=>{var o;return(o=u.default)==null?void 0:o.call(u)}}}),E=t.defineComponent({name:"VGoogleHeatmap",props:{options:{required:!0,type:Object}},setup(i,{expose:n,slots:l}){const{gmapApi:u}=L(),s=t.inject("google-map");t.onMounted(()=>{if(s!=null&&s.value&&u.value){const e={...i.options};a.value=t.markRaw(new u.value.maps.visualization.HeatmapLayer({map:s.value,...e}))}});const a=t.ref(null);return t.watch(()=>i.options,(e,c)=>{!a.value||k(e,c)||a.value.setOptions(i.options)},{deep:!0}),t.onUnmounted(()=>{a.value&&(a.value.setMap(null),a.value=null)}),n({heatmap:a}),()=>{var e;return(e=l.default)==null?void 0:e.call(l)}}}),P=t.defineComponent({name:"VGooglePolygon",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","update:model-value"],setup(i,{emit:n,expose:l,slots:u}){const{gmapApi:s}=L(),a=t.inject("google-map");t.onMounted(()=>{if(a!=null&&a.value&&s.value){const o={...i.options};v.value&&(o.paths=[...v.value]),e.value=t.markRaw(new s.value.maps.Polygon({map:a.value,...o})),f()}});const e=t.ref(null);let c=null,p=null;const v=t.computed({get(){return i.modelValue},set(o){n("update:model-value",o)}});function f(){e.value&&(c=e.value.addListener("click",h),p=e.value.addListener("mouseup",()=>{var d,r,m;const o=(m=(r=(d=e.value)==null?void 0:d.getPath())==null?void 0:r.getArray())==null?void 0:m.map(O=>O.toJSON());o&&(v.value=[...o])}))}function g(){c&&c.remove(),p&&p.remove()}function h(o){n("click",o)}return t.watch(()=>i.options,(o,d)=>{!e.value||k(o,d)||e.value.setOptions(i.options)},{deep:!0}),t.watch(v,(o,d)=>{k(o,d)||!e.value||!o||e.value.setPath(o)}),l({polygon:e}),t.onBeforeUnmount(()=>{g(),e.value&&(e.value.setMap(null),e.value=null)}),()=>{var o;return(o=u.default)==null?void 0:o.call(u)}}}),N=t.defineComponent({name:"VGooglePolyline",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","update:model-value"],setup(i,{emit:n,expose:l,slots:u}){const{gmapApi:s}=L(),a=t.inject("google-map");t.onMounted(()=>{if(a!=null&&a.value&&s.value){const o={...i.options};v.value&&(o.path=[...v.value]),e.value=t.markRaw(new s.value.maps.Polyline({...o,map:a.value})),f()}});const e=t.ref(null);let c=null,p=null;const v=t.computed({get(){return i.modelValue},set(o){n("update:model-value",o)}});function f(){e.value&&(c=e.value.addListener("click",h),p=e.value.addListener("mouseup",()=>{var d,r,m;const o=(m=(r=(d=e.value)==null?void 0:d.getPath())==null?void 0:r.getArray())==null?void 0:m.map(O=>O.toJSON());o&&(v.value=[...o])}))}function g(){c&&c.remove(),p&&p.remove()}function h(o){n("click",o)}return t.watch(()=>i.options,(o,d)=>{!e.value||k(o,d)||e.value.setOptions(i.options)},{deep:!0}),t.watch(v,(o,d)=>{k(o,d)||!e.value||!o||e.value.setPath(o)}),l({polyline:e}),t.onBeforeUnmount(()=>{g(),e.value&&(e.value.setMap(null),e.value=null)}),()=>{var o;return(o=u.default)==null?void 0:o.call(u)}}}),U=t.defineComponent({name:"VGoogleRectangle",props:{options:{required:!0,type:Object},modelValue:{default:null,type:Object}},emits:["click","update:model-value"],setup(i,{emit:n,expose:l,slots:u}){const{gmapApi:s}=L(),a=t.inject("google-map");t.onMounted(()=>{if(a!=null&&a.value&&s.value){const o={...i.options};v.value&&(o.bounds={...v.value}),e.value=t.markRaw(new s.value.maps.Rectangle({map:a.value,...o})),f()}});const e=t.ref(null);let c=null,p=null;const v=t.computed({get(){return i.modelValue},set(o){n("update:model-value",o)}});function f(){e.value&&(c=e.value.addListener("click",h),p=e.value.addListener("bounds_changed",()=>{var d,r;const o=(r=(d=e.value)==null?void 0:d.getBounds())==null?void 0:r.toJSON();o&&(v.value={...o})}))}function g(){c&&c.remove(),p&&p.remove()}function h(o){n("click",o)}return t.watch(()=>i.options,(o,d)=>{!e.value||k(o,d)||e.value.setOptions(i.options)},{deep:!0}),t.watch(v,(o,d)=>{k(o,d)||!e.value||!o||e.value.setBounds(o)}),l({rectangle:e}),t.onBeforeUnmount(()=>{g(),e.value&&(e.value.setMap(null),e.value=null)}),()=>{var o;return(o=u.default)==null?void 0:o.call(u)}}}),B={key:0,class:"v-google-info-window__container"},$=t.defineComponent({__name:"VGoogleInfoWindow",props:{options:{default:null,type:Object},modelValue:{type:Boolean,default:null}},emits:["click","update:model-value"],setup(i,{expose:n,emit:l}){const u=i,s=t.useSlots(),{gmapApi:a}=L(),e=t.inject("google-map"),c=t.inject("marker",t.ref(null));t.onMounted(()=>{var y;a.value&&(f.value=t.markRaw(new a.value.maps.InfoWindow({...u.options,content:o.value?v.value:(y=u.options)==null?void 0:y.content})),r(),d.value&&O())});const p=t.ref(!1),v=t.ref(),f=t.ref(null);let g=null,h=null;const o=t.computed(()=>{var y;return(y=s.default)==null?void 0:y.call(s).some(_=>_.type!==Comment)}),d=t.computed({get(){return u.modelValue},set(y){l("update:model-value",y)}});function r(){var y;!(c!=null&&c.value)||!f.value||(h=(y=c.value)==null?void 0:y.addListener("click",O),g=f.value.addListener("closeclick",O))}function m(){h&&h.remove(),g&&g.remove()}function O(){!f.value||!(e!=null&&e.value)||(p.value=!p.value,p.value?f.value.open({map:e.value,anchor:c==null?void 0:c.value}):f.value.close(),d.value=p.value)}return t.watch(()=>u.options,(y,_)=>{!f.value||k(y,_)||f.value.setOptions(u.options)},{deep:!0}),t.watch(d,y=>{y===null||y===p.value||O()}),n({infoWindow:f}),t.onBeforeUnmount(()=>{m(),f.value&&(f.value.close(),f.value=null)}),(y,_)=>t.unref(o)?(t.openBlock(),t.createElementBlock("div",B,[t.createElementVNode("div",{ref_key:"infoWindowRef",ref:v},[t.renderSlot(y.$slots,"default",{},void 0,!0)],512)])):t.createCommentVNode("",!0)}});const q=I($,[["__scopeId","data-v-2f6a5bf7"]]),x=i=>{i.component("VGoogleMap",M),i.component("VGoogleCircle",V),i.component("VGoogleMarker",A),i.component("VGoogleHeatmap",E),i.component("VGooglePolygon",P),i.component("VGooglePolyline",N),i.component("VGoogleRectangle",U),i.component("VGoogleInfoWindow",q)};exports.useGmapLoader=L;exports.vGoogleMaps=x;
